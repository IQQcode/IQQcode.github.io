(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{486:function(t,_,o){"use strict";o.r(_);var v=o(3),n=Object(v.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h2",{attrs:{id:"线程安全的集合"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#线程安全的集合"}},[t._v("#")]),t._v(" 线程安全的集合")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210617195746.png",alt:"image-20201002143638309"}})]),t._v(" "),_("p",[t._v("分为三大类：")]),t._v(" "),_("h3",{attrs:{id:"_1-遗留的线程安全集合"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-遗留的线程安全集合"}},[t._v("#")]),t._v(" 1. 遗留的线程安全集合")]),t._v(" "),_("ul",[_("li",[t._v("Hashtable")]),t._v(" "),_("li",[t._v("Vector")])]),t._v(" "),_("h3",{attrs:{id:"_2-collections-修饰的线程安全集合"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-collections-修饰的线程安全集合"}},[t._v("#")]),t._v(" 2. Collections 修饰的线程安全集合")]),t._v(" "),_("p",[_("code",[t._v("synchronized")]),t._v("修饰")]),t._v(" "),_("p",[_("code",[t._v("metex")]),t._v("即为"),_("code",[t._v("this")]),t._v("当前对象")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210617203440.png",alt:"image-20201002144359521"}})]),t._v(" "),_("ul",[_("li",[t._v("Collections. synchronizedCollection")]),t._v(" "),_("li",[t._v("Collections. synchronizedList")]),t._v(" "),_("li",[t._v("Collections. synchronizedMap")]),t._v(" "),_("li",[t._v("Collections. synchronizedSet")]),t._v(" "),_("li",[t._v("Collections. synchronizedNavigableMap")]),t._v(" "),_("li",[t._v("Collections.synchronizedNavigableSet")]),t._v(" "),_("li",[t._v("Collections. synchronizedSortedMap")]),t._v(" "),_("li",[t._v("Collections. synchronizedSortedSet")])]),t._v(" "),_("h3",{attrs:{id:"_3-juc包下的集合类"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-juc包下的集合类"}},[t._v("#")]),t._v(" 3. JUC包下的集合类")]),t._v(" "),_("p",[t._v("JUC包下的线程安全集合类，包括三大类：Blocking、CopyOnWrite、Concurrent")]),t._v(" "),_("p",[_("strong",[t._v("Blocking")]),t._v(" 基于"),_("code",[t._v("Lock")]),t._v("锁实现，提供用来阻塞的方法")]),t._v(" "),_("p",[_("strong",[t._v("CopyOnWrite")]),t._v("开销大，写时复制，读时共享，适用于读多写少")]),t._v(" "),_("p",[_("strong",[t._v("Concurrent集合")]),t._v("，使用"),_("strong",[t._v("CAS优化")]),t._v("，吞吐量高")]),t._v(" "),_("ul",[_("li",[_("strong",[t._v("弱一致性")]),t._v("。迭代器便利时，容器发生修改，依然可进行遍历，内容是"),_("font",{attrs:{color:"red"}},[t._v("旧的")])],1)]),t._v(" "),_("p",[t._v("遍历时发生了修改，使用"),_("strong",[t._v("fail-fast")]),t._v("快速失败机制，让便利立刻失效，抛出"),_("code",[t._v("ConcurrentModificationException")]),t._v("，不再继续遍历")]),t._v(" "),_("p",[_("strong",[t._v("使用线程安全的集合类，就一定能保证线程安全吗？")])]),t._v(" "),_("ul",[_("li",[t._v("并不是")])]),t._v(" "),_("p",[t._v("线程安全的集合类"),_("strong",[t._v("ConcurrentHashMap")]),t._v("是线程安全的，它的"),_("code",[t._v("get")]),t._v("、"),_("code",[t._v("put")]),t._v("操作是原子的，但是在同一个方法中"),_("strong",[t._v("组合起来使用")]),t._v("，就不能保证"),_("strong",[t._v("线程安全了")])]),t._v(" "),_("p",[_("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210617195753.png",alt:"image-20201002150008971"}})]),t._v(" "),_("p",[t._v("当前"),_("strong",[t._v("ConcurrentHashMap")]),t._v("就是一份共享资源，多个线程对其进行读取，添加数据。怎么保证线程安全呢？")]),t._v(" "),_("ul",[_("li",[t._v("加锁，放入"),_("code",[t._v("synchronized")]),t._v("同步块或者同步方法中，效率低")]),t._v(" "),_("li",[_("code",[t._v("computeIfAbsent()")]),t._v("，保证"),_("code",[t._v("k-v")]),t._v("的安全性")])])])}),[],!1,null,null,null);_.default=n.exports}}]);