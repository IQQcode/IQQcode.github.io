(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{506:function(t,s,a){"use strict";a.r(s);var n=a(3),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[s("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210621202735.svg",alt:"è¾…åŠ©å·¥å…·ç±»"}})]),t._v(" "),s("h2",{attrs:{id:"_1-countdownlatch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-countdownlatch"}},[t._v("#")]),t._v(" 1.CountDownLatch")]),t._v(" "),s("p",[s("strong",[t._v("å€’è®¡æ—¶é”ğŸ”’")]),t._v("ï¼šåŒæ­¥è¾…åŠ©ç±»ï¼Œé€šè¿‡å®ƒå¯ä»¥é˜»å¡å½“å‰çº¿ç¨‹ã€‚å®ç°ä¸€ä¸ªçº¿ç¨‹æˆ–è€…å¤šä¸ªçº¿ç¨‹ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹æ‰§è¡Œçš„æ“ä½œå®Œæˆã€‚")]),t._v(" "),s("p",[t._v("ä½¿ç”¨ä¸€ä¸ªç»™å®šçš„è®¡æ•°å™¨è¿›è¡Œåˆå§‹åŒ–ï¼Œè¯¥è®¡æ•°å™¨çš„æ“ä½œæ˜¯åŸå­æ“ä½œï¼Œå³åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ“ä½œè¯¥è®¡æ•°å™¨ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("ã€åŸç†ã€‘")]),t._v("ï¼šå¤šä¸ªçº¿ç¨‹ååŒæ‰§è¡Œä»»åŠ¡ï¼Œæ¯ä¸ªçº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œï¼Œ"),s("strong",[t._v("è®¡æ•°")]),t._v("å‡ä¸€"),s("code",[t._v("countDown()")])]),t._v(" "),s("ul",[s("li",[t._v("æ„é€ æ–¹æ³•ç”¨æ¥åˆå§‹åŒ–"),s("strong",[t._v("ç­‰å¾…è®¡æ•°å€¼")])]),t._v(" "),s("li",[s("code",[t._v("await()")]),t._v("ç”¨æ¥ç­‰å¾…è®¡æ•°å™¨å½’é›¶")]),t._v(" "),s("li",[s("code",[t._v("countDown()")]),t._v("è®©è®¡æ•°å™¨å‡ä¸€")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210621202740.png",alt:"image-20201002113234905"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210621202744.png",alt:"20190815191955880"}})]),t._v(" "),s("p",[t._v("è°ƒç”¨è¯¥ç±»await()æ–¹æ³•çš„çº¿ç¨‹ä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨è¯¥ç±»çš„countDown()æ–¹æ³•ï¼Œä½¿å½“å‰è®¡æ•°å™¨çš„å€¼å˜ä¸º0ä¸ºæ­¢ã€‚æ¯æ¬¡è°ƒç”¨è¯¥ç±»çš„countDown()æ–¹æ³•ï¼Œå½“å‰è®¡æ•°å™¨çš„å€¼å°±ä¼šå‡1ã€‚å½“è®¡æ•°å™¨çš„å€¼å‡ä¸º0çš„æ—¶å€™ï¼Œæ‰€æœ‰å› è°ƒç”¨await()æ–¹æ³•è€Œå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹å°±ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚è¿™ç§æ“ä½œåªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œå› ä¸º"),s("strong",[t._v("è¯¥ç±»ä¸­çš„è®¡æ•°å™¨ä¸èƒ½è¢«é‡ç½®")]),t._v("ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("å¦‚æœéœ€è¦ä¸€ä¸ªå¯ä»¥é‡ç½®è®¡æ•°æ¬¡æ•°çš„ç‰ˆæœ¬ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨"),s("strong",[t._v("CyclicBarrier")]),t._v("ç±»ã€‚")])]),t._v(" "),s("p",[t._v("CountDownLatchæ”¯æŒç»™å®šæ—¶é—´çš„ç­‰å¾…ï¼Œè¶…è¿‡ä¸€å®šçš„æ—¶é—´ä¸å†ç­‰å¾…ï¼Œä½¿ç”¨æ—¶åªéœ€è¦åœ¨countDown()æ–¹æ³•ä¸­ä¼ å…¥éœ€è¦ç­‰å¾…çš„æ—¶é—´å³å¯ã€‚æ­¤æ—¶ï¼ŒcountDown()æ–¹æ³•çš„æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" timeout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TimeUnit")]),t._v(" unit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h4",{attrs:{id:"ä½¿ç”¨åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨åœºæ™¯"}},[t._v("#")]),t._v(" ä½¿ç”¨åœºæ™¯")]),t._v(" "),s("p",[t._v("åœ¨æŸäº›ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œç¨‹åºæ‰§è¡Œéœ€è¦ç­‰å¾…æŸä¸ªæ¡ä»¶å®Œæˆåæ‰èƒ½ç»§ç»­æ‰§è¡Œåç»­çš„æ“ä½œã€‚")]),t._v(" "),s("p",[t._v("å…¸å‹çš„åº”ç”¨ä¸ºå¹¶è¡Œè®¡ç®—ï¼š")]),t._v(" "),s("p",[s("strong",[t._v("å½“æŸä¸ªå¤„ç†çš„è¿ç®—é‡å¾ˆå¤§æ—¶ï¼Œå¯ä»¥å°†è¯¥è¿ç®—ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå­ä»»åŠ¡ï¼Œç­‰å¾…æ‰€æœ‰çš„å­ä»»åŠ¡éƒ½å®Œæˆä¹‹åï¼Œçˆ¶ä»»åŠ¡å†æ‹¿åˆ°æ‰€æœ‰å­ä»»åŠ¡çš„è¿ç®—ç»“æœè¿›è¡Œæ±‡æ€»ã€‚")])]),t._v(" "),s("p",[t._v("ã€e.g.ã€‘")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬ä½¿ç”¨åªæœ‰2ä¸ªæ ¸å¿ƒçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œåˆ†åˆ«æ‰§è¡Œ"),s("em",[t._v("æŸ¥è¯¢è®¢å•")]),t._v("å’Œ"),s("em",[t._v("æ´¾é€è®¢å•")]),t._v("çš„æ“ä½œï¼Œå¹¶ä¸”åˆå§‹åŒ–äº†ä¸€ä¸ªå¤§å°ä¸º 2 çš„ CountDownLatchï¼Œæ¯æ¬¡æŸ¥è¯¢å®Œåï¼Œéƒ½è¦ countDown()ï¼›")]),t._v(" "),s("p",[t._v("ä¸»çº¿ç¨‹åˆ™ä¸€ç›´ç­‰å¾…å‡ä¸º 0 äº†ä¹‹åï¼Œæ‰å¼€å§‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚")]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"_2-cyclicbarrier"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-cyclicbarrier"}},[t._v("#")]),t._v(" 2. CyclicBarrier")]),t._v(" "),s("h4",{attrs:{id:"æ¦‚è¿°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ¦‚è¿°"}},[t._v("#")]),t._v(" æ¦‚è¿°")]),t._v(" "),s("p",[t._v("æ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»ï¼Œå…è®¸"),s("strong",[t._v("ä¸€ç»„çº¿ç¨‹")]),t._v("ç›¸äº’ç­‰å¾…ï¼Œç›´åˆ°åˆ°è¾¾æŸä¸ªå…¬å…±çš„å±éšœç‚¹ï¼Œé€šè¿‡å®ƒå¯ä»¥å®Œæˆ"),s("strong",[t._v("å¤šä¸ªçº¿ç¨‹ä¹‹é—´ç›¸äº’ç­‰å¾…")]),t._v("ï¼Œåªæœ‰å½“æ¯ä¸ªçº¿ç¨‹éƒ½å‡†å¤‡å°±ç»ªåï¼Œæ‰èƒ½å„è‡ªç»§ç»­å¾€ä¸‹æ‰§è¡Œåé¢çš„æ“ä½œã€‚")]),t._v(" "),s("p",[t._v("ä¸CountDownLatchæœ‰ç›¸ä¼¼çš„åœ°æ–¹ï¼Œéƒ½æ˜¯ä½¿ç”¨è®¡æ•°å™¨å®ç°ï¼Œå½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº†CyclicBarrierçš„"),s("code",[t._v("await()")]),t._v("æ–¹æ³•åï¼Œè¯¥çº¿ç¨‹å°±è¿›å…¥äº†ç­‰å¾…çŠ¶æ€ï¼Œè€Œä¸”è®¡æ•°å™¨æ‰§è¡ŒåŠ 1æ“ä½œï¼Œå½“è®¡æ•°å™¨çš„å€¼è¾¾åˆ°äº†è®¾ç½®çš„åˆå§‹å€¼ï¼Œè°ƒç”¨await()æ–¹æ³•è¿›å…¥ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ä¼šè¢«å”¤é†’ï¼Œç»§ç»­æ‰§è¡Œå„è‡ªåç»­çš„æ“ä½œã€‚")]),t._v(" "),s("p",[s("strong",[t._v("CyclicBarrieråœ¨é‡Šæ”¾ç­‰å¾…çº¿ç¨‹åå¯ä»¥é‡ç”¨ï¼Œæ‰€ä»¥ï¼ŒCyclicBarrieråˆè¢«ç§°ä¸ºå¾ªç¯å±éšœã€‚")])]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆå§‹åŒ–å€¼ä¸º5çš„æ …æ ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CyclicBarrier")]),t._v(" cyclicBarrier "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CyclicBarrier")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¯ä¸ªçº¿ç¨‹è°ƒç”¨ await()")]),t._v("\ncyclicBarrier"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç­‰åˆ°æœ‰ 5 ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œäº† await() ä¹‹åï¼Œç»§ç»­æ‰§è¡Œã€‚")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¹¶ä¸” æ …æ çš„ è®¡æ•°å™¨ä¼šè‡ªåŠ¨é‡ç½®ä¸º 5 ï¼Œå¯ä»¥æ¥ç€ç”¨")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("h4",{attrs:{id:"cyclicbarrierä¸countdownlatchçš„åŒºåˆ«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cyclicbarrierä¸countdownlatchçš„åŒºåˆ«"}},[t._v("#")]),t._v(" CyclicBarrierä¸CountDownLatchçš„åŒºåˆ«")]),t._v(" "),s("ul",[s("li",[t._v("CountDownLatchçš„"),s("strong",[t._v("è®¡æ•°å™¨")]),t._v("åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œè€ŒCyclicBarrierçš„è®¡æ•°å™¨å¯ä»¥ä½¿ç”¨"),s("code",[t._v("reset()")]),t._v("æ–¹æ³•è¿›è¡Œé‡ç½®ï¼Œå¹¶ä¸”å¯ä»¥å¾ªç¯ä½¿ç”¨")]),t._v(" "),s("li",[t._v("CountDownLatchä¸»è¦å®ç°1ä¸ªæˆ–nä¸ªçº¿ç¨‹éœ€è¦ç­‰å¾…å…¶ä»–çº¿ç¨‹å®ŒæˆæŸé¡¹æ“ä½œä¹‹åï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæè¿°çš„æ˜¯1ä¸ªæˆ–nä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹çš„å…³ç³»ã€‚è€ŒCyclicBarrierä¸»è¦å®ç°äº†å¤šä¸ªçº¿ç¨‹ä¹‹é—´ç›¸äº’ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰çš„çº¿ç¨‹éƒ½æ»¡è¶³äº†æ¡ä»¶ä¹‹åï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œåç»­çš„æ“ä½œï¼Œæè¿°çš„æ˜¯å„ä¸ªçº¿ç¨‹å†…éƒ¨ç›¸äº’ç­‰å¾…çš„å…³ç³»ã€‚")]),t._v(" "),s("li",[t._v("CyclicBarrierèƒ½å¤Ÿå¤„ç†æ›´å¤æ‚çš„åœºæ™¯ï¼Œå¦‚æœè®¡ç®—å‘ç”Ÿé”™è¯¯ï¼Œå¯ä»¥é‡ç½®è®¡æ•°å™¨è®©çº¿ç¨‹é‡æ–°æ‰§è¡Œä¸€æ¬¡ã€‚")])]),t._v(" "),s("p",[t._v("ã€e.g.ã€‘")]),t._v(" "),s("p",[t._v("åœ¨è‹±é›„è”ç›Ÿä¸­ï¼Œé€‰å¥½è‹±é›„ä¹‹åï¼Œä¼šç­‰å¾…æ‰€æœ‰ 10 ä¸ªç©å®¶è¿›åº¦æ¡éƒ½åˆ° 100% æ‰å¼€å§‹æ¸¸æˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ CyclicBarrier æ¥æ¨¡æ‹Ÿè¿™ä¸ªåœºæ™¯")]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"_3-semaphore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-semaphore"}},[t._v("#")]),t._v(" 3. Semaphore")]),t._v(" "),s("h3",{attrs:{id:"æ¦‚è¿°-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ¦‚è¿°-2"}},[t._v("#")]),t._v(" æ¦‚è¿°")]),t._v(" "),s("p",[s("strong",[t._v("Semaphoreä¿¡å·é‡ï¼š")]),t._v(" ç”¨æ¥é™åˆ¶è®¿é—®å…±äº«èµ„æºçš„"),s("strong",[t._v("çº¿ç¨‹æ•°")]),t._v("ï¼Œ"),s("strong",[t._v("æ§åˆ¶åŒä¸€æ—¶é—´å¹¶å‘çº¿ç¨‹çš„æ•°ç›®")])]),t._v(" "),s("p",[t._v("èƒ½å¤Ÿå®Œæˆå¯¹äºä¿¡å·é‡çš„æ§åˆ¶ï¼Œå¯ä»¥æ§åˆ¶æŸä¸ªèµ„æºå¯è¢«åŒæ—¶è®¿é—®çš„ä¸ªæ•°ã€‚")]),t._v(" "),s("ul",[s("li",[t._v("æ¯æ¬¡åªå…è®¸è§„å®šæ•°é‡çš„çº¿ç¨‹æ¥è·å–èµ„æº")]),t._v(" "),s("li",[t._v("å¾…è§„å®šçš„çº¿ç¨‹æ‰§è¡Œå®Œé‡Šæ”¾äº†ä¿¡å·é‡ï¼Œå†è°ƒåº¦è§„å®šæ•°é‡çš„çº¿ç¨‹ç»§ç»­æ‰§è¡Œ")])]),t._v(" "),s("p",[t._v("æä¾›äº†ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•â€”â€”acquire()æ–¹æ³•å’Œrelease()æ–¹æ³•ã€‚")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("acquire()")]),t._v("ï¼šè·å–ä¸€ä¸ªè®¸å¯ï¼Œå¦‚æœæ²¡æœ‰åˆ™ç­‰å¾…")]),t._v(" "),s("li",[s("code",[t._v("release()")]),t._v("ï¼šåœ¨æ“ä½œå®Œæˆåé‡Šæ”¾å¯¹åº”çš„è®¸å¯")])]),t._v(" "),s("p",[t._v("Semaphoreç»´æŠ¤äº†å½“å‰è®¿é—®çš„ä¸ªæ•°ï¼Œé€šè¿‡æä¾›"),s("em",[t._v("åŒæ­¥æœºåˆ¶")]),t._v("æ¥æ§åˆ¶åŒæ—¶è®¿é—®çš„ä¸ªæ•°")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. åˆ›å»ºSemaphoreå¯¹è±¡,å…è®¸ä¸‰ä¸ªçº¿ç¨‹åŒæ—¶è·å–èµ„æº")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Semaphore")]),t._v(" semaphore "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Semaphore")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. 10ä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//è·å–ä¿¡å·é‡")]),t._v("\n            semaphore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("acquire")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            \n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æ‰§è¡Œå®Œï¼Œé‡Šæ”¾ä¿¡å·é‡")]),t._v("\n            semaphore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("release")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("h3",{attrs:{id:"ä½¿ç”¨åœºæ™¯-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨åœºæ™¯-2"}},[t._v("#")]),t._v(" ä½¿ç”¨åœºæ™¯")]),t._v(" "),s("p",[t._v("ä½¿ç”¨"),s("code",[t._v("Semaphore")]),s("strong",[t._v("é™æµ")]),t._v("ï¼Œåœ¨è®¿é—®é«˜å³°æœŸæ—¶ï¼Œè®©è¯·æ±‚çº¿ç¨‹é˜»å¡ï¼Œé«˜å³°æœŸè¿‡å»å†é‡Šæ”¾è®¸å¯ï¼Œå½“ç„¶å®ƒ"),s("font",{attrs:{color:"red"}},[t._v("åªé€‚åˆé™åˆ¶å•æœºçº¿ç¨‹")]),t._v("æ•°é‡ï¼ˆä¸é€‚åˆåˆ†å¸ƒå¼ï¼‰ï¼Œå¹¶ä¸”"),s("strong",[t._v("ä»…æ˜¯é™åˆ¶çº¿ç¨‹æ•°")]),t._v("ï¼Œè€Œä¸æ˜¯é™åˆ¶èµ„æºæ•°ï¼ˆä¾‹å¦‚å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œè¯·å¯¹æ¯”Tomcat LimitLatchçš„å®ç°ï¼‰")],1),t._v(" "),s("p",[t._v("é€‚åˆç”¨åœ¨"),s("strong",[t._v("èµ„æºæ•°ä¸çº¿ç¨‹æ•°ç›¸åŒ")]),t._v("æ—¶ä½¿ç”¨ï¼ŒSemaphoreå¸¸ç”¨äºä»…èƒ½æä¾›æœ‰é™è®¿é—®çš„èµ„æºï¼Œæ¯”å¦‚ï¼š"),s("strong",[t._v("æ•°æ®åº“è¿æ¥æ•°")])]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"ã€ä¸‰è€…å°ç»“ã€‘"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ã€ä¸‰è€…å°ç»“ã€‘"}},[t._v("#")]),t._v(" ã€ä¸‰è€…å°ç»“ã€‘")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("CountDownLatch å¯ä»¥å®ç°è®¡æ•°ç­‰å¾…ï¼Œä¸»è¦ç”¨äº"),s("strong",[t._v("Açº¿ç¨‹ç­‰å¾…å…¶ä»–å‡ ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œåå†æ‰§è¡Œï¼›")])])]),t._v(" "),s("li",[s("p",[t._v("CyclicBarrier å®ç°å¾ªç¯æ …æ ï¼Œä¸»è¦ç”¨äº"),s("strong",[t._v("ä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…è‡³æŸä¸ªçŠ¶æ€ï¼Œç„¶åè¿™ä¸€ç»„çº¿ç¨‹å†åŒæ—¶æ‰§è¡Œï¼›")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("CountDownLatch æ˜¯ä¸èƒ½å¤Ÿé‡ç”¨çš„ï¼Œè€Œ CyclicBarrier æ˜¯å¯ä»¥é‡ç”¨çš„")])])]),t._v(" "),s("li",[s("p",[t._v("Semaphore ä¿¡å·é‡ï¼Œä¸»è¦å¼ºè°ƒåªæœ‰"),s("strong",[t._v("æŸäº›ä¸ªæ•°é‡çš„çº¿ç¨‹èƒ½æ‹¿åˆ°èµ„æºæ‰§è¡Œ")]),t._v("ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("Semaphore å…¶å®å’Œé”æœ‰ç‚¹ç±»ä¼¼ï¼Œå®ƒä¸€èˆ¬ç”¨äºæ§åˆ¶å¯¹ æŸç»„ èµ„æºçš„è®¿é—®æƒé™ï¼Œè€Œé”æ˜¯æ§åˆ¶å¯¹ æŸä¸ª èµ„æºçš„è®¿é—®æƒé™")])])])]),t._v(" "),s("h2",{attrs:{id:"_4-readwritelock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-readwritelock"}},[t._v("#")]),t._v(" 4. ReadWriteLock")]),t._v(" "),s("p",[t._v("ç‹¬å é”ï¼ˆå†™é”ï¼‰ï¼šä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å æœ‰")]),t._v(" "),s("p",[t._v("å…±äº«é”ï¼ˆè¯»é”ï¼‰ï¼šå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å æœ‰")]),t._v(" "),s("ul",[s("li",[t._v("è¯»<----\x3eè¯»ï¼šå¯ä»¥å…±å­˜")]),t._v(" "),s("li",[t._v("è¯»<----\x3eå†™ï¼šäº’æ–¥ï¼Œä¸å¯å…±å­˜")]),t._v(" "),s("li",[t._v("å†™<----\x3eå†™ï¼šäº’æ–¥ï¼Œä¸å¯å…±å­˜")])]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyCache")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" map "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HashMap")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//è¯»å†™é”ï¼Œæ›´åŠ ç»†ç²’åº¦æ§åˆ¶")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReadWriteLock")]),t._v(" readWriteLock "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReentrantReadWriteLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Lock")]),t._v(" lock "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReentrantLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        readWriteLock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" writing "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" write over!"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            readWriteLock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unlock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        readWriteLock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" reading "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" read over"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            readWriteLock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeLock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unlock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReadWriteLockTest")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyCache")]),t._v(" cache "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyCache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//å†™å…¥æ“ä½œ")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" temp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                cache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" temp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("valueOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//è¯»å–æ“ä½œ")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" temp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                cache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("valueOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br"),s("span",{staticClass:"line-number"},[t._v("53")]),s("br"),s("span",{staticClass:"line-number"},[t._v("54")]),s("br"),s("span",{staticClass:"line-number"},[t._v("55")]),s("br")])]),s("p",[t._v("åŠ ä¸Š"),s("code",[t._v("ReadWriteLock")]),t._v("ä¹‹åï¼Œèƒ½å¤Ÿæ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶é”ï¼Œé¿å…è¯»å†™åŒæ—¶å‘ç”Ÿé€ æˆâ€œè„è¯»â€ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210621202753.png",alt:""}})])])}),[],!1,null,null,null);s.default=e.exports}}]);