(window.webpackJsonp=window.webpackJsonp||[]).push([[410],{737:function(v,_,e){"use strict";e.r(_);var t=e(3),r=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("p",[_("strong",[v._v("流程总述：")])]),v._v(" "),_("ol",[_("li",[v._v("URL解析：解析 http 协议、端口、资源地址")]),v._v(" "),_("li",[v._v("DNS解析：将域名解析为IP地址，并且通过ARP协议找到MAC地址")]),v._v(" "),_("li",[v._v("TCP连接：TCP三次握手")]),v._v(" "),_("li",[v._v("发送HTTP请求")]),v._v(" "),_("li",[v._v("服务器处理HTTP请求并返回响应")]),v._v(" "),_("li",[v._v("浏览器解析并渲染页面")]),v._v(" "),_("li",[v._v("断开连接：TCP四次挥手")])]),v._v(" "),_("h2",{attrs:{id:"_1-url解析"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-url解析"}},[v._v("#")]),v._v(" 1. URL解析")]),v._v(" "),_("p",[_("code",[v._v("https://www.baidu.com/")])]),v._v(" "),_("p",[v._v("URL遵循的规则：")]),v._v(" "),_("div",{staticClass:"language-http line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-http"}},[_("code",[_("span",{pre:!0,attrs:{class:"token header"}},[_("span",{pre:!0,attrs:{class:"token header-name keyword"}},[v._v("scheme")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(":")]),_("span",{pre:!0,attrs:{class:"token header-value"}},[v._v("//host.domain:port/path/filename")])]),v._v("\n")])]),v._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[v._v("1")]),_("br")])]),_("ul",[_("li",[_("code",[v._v("scheme")]),v._v("：定义应用层协议类型，如HTTP、HTTPS、FTP")]),v._v(" "),_("li",[_("code",[v._v("host")]),v._v("：定义域主机（HTTP默认为www）")]),v._v(" "),_("li",[_("code",[v._v("domain")]),v._v("：定义域名")]),v._v(" "),_("li",[_("code",[v._v("port")]),v._v("：主机端口号（HTTP默认80，HTTPS默认443）")]),v._v(" "),_("li",[_("code",[v._v("path")]),v._v("：服务器上的资源路径")]),v._v(" "),_("li",[_("code",[v._v("filename")]),v._v("：资源名称")])]),v._v(" "),_("h2",{attrs:{id:"_2-dns解析"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-dns解析"}},[v._v("#")]),v._v(" 2. DNS解析")]),v._v(" "),_("ol",[_("li",[v._v("浏览器缓存：先查找本地浏览器的 DNS 缓存（浏览器的缓存）")]),v._v(" "),_("li",[v._v("操作系统缓存：查看本地 **hosts **文件有没有相应的映射记录")]),v._v(" "),_("li",[v._v("路由缓存：路由器DNS缓存")]),v._v(" "),_("li",[_("strong",[v._v("ISP 的 DNS 服务器")]),v._v("：向本地 DNS 服务器【网络运营商（电信、移动、联通）】发起查询请求。\n"),_("ul",[_("li",[v._v("本地DNS服务器收到请求后，会先查下自己的缓存记录，如果查到了直接返回就结束了；")]),v._v(" "),_("li",[v._v("如果没有查到，本地DNS服务器就会向"),_("strong",[v._v("DNS根域名服务器")]),v._v("发起查询请求")])])]),v._v(" "),_("li",[v._v("根域名服务器收到请求后，发现是个"),_("code",[v._v(".com")]),v._v(" 的域名，递归向下请求"),_("code",[v._v(".com")]),v._v("顶级域名服务器")]),v._v(" "),_("li",[v._v("本地 DNS 服务器接到回信后，向 "),_("code",[v._v(".com")]),v._v(" 的"),_("strong",[v._v("顶级域名服务器")]),v._v("发起查询请求，发现为"),_("code",[v._v("163.com")]),v._v("，进入下一级查找")]),v._v(" "),_("li",[_("code",[v._v("163.com")]),_("strong",[v._v("权威域名服务器")]),v._v("接收到请求后，确认了是自己管理的域名，把 www.163.com 的ip告诉了 本地DNS服务器")]),v._v(" "),_("li",[v._v("本地DNS服务器接收到回信后，将IP地址返回给本机，并做缓存")])]),v._v(" "),_("br"),v._v(" "),_("h2",{attrs:{id:"_2-tcp三次握手建立连接"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-tcp三次握手建立连接"}},[v._v("#")]),v._v(" 2. TCP三次握手建立连接")]),v._v(" "),_("p",[v._v("TCP/IP分模型建立连接")]),v._v(" "),_("p",[v._v("【应用层】：发送HTTP请求")]),v._v(" "),_("p",[v._v("【传输层】：传输TCP报文，建立TCP连接")]),v._v(" "),_("p",[v._v("【网络层】：IP协议 查询MAC地址（ARP寻址），进行数据传输、路由选择")]),v._v(" "),_("p",[v._v("【数据链路层】：以太网协议将数据分为以“帧”为单位的数据包进行发送")]),v._v(" "),_("p",[v._v("【物理层】：转化为0101的光电信号传输")]),v._v(" "),_("br"),v._v(" "),_("p",[_("strong",[v._v("三次握手：")])]),v._v(" "),_("p",[_("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626193340.png",alt:""}})]),v._v(" "),_("p",[_("strong",[v._v("【握手阶段】")])]),v._v(" "),_("ol",[_("li",[v._v("建立链接前需要 Server 端先监听端口，因此 Server 端建立链接前的初始状态就是 "),_("font",{attrs:{color:"red"}},[v._v("LISTEN")]),v._v(" 状态，这时 Client 端准备建立链接。在第一次消息发送中，Client随机选取一个序列号作为自己的初始序号发送给Server，Client 端的链接状态变成了 "),_("font",{attrs:{color:"red"}},[v._v("SYN_SENT")]),v._v(" 状态；")],1),v._v(" "),_("li",[_("strong",[v._v("Server收到了来自Client的连接请求，如果在资源条件合理的情况下，服务器为该TCP连接分配缓存和变量")]),v._v("。Server使用ACK对A的数据包进行确认，因为已经收到了序列号为"),_("code",[v._v("x")]),v._v("的数据包，准备接收序列号为 "),_("code",[v._v("x+1")]),v._v(" 的包，所以 "),_("code",[v._v("ack=x+1")]),v._v("，同时B告诉A自己的初始序列号，就是"),_("code",[v._v("seq=y")]),v._v("；发送完 ACK 和 SYN 后，Server 端的链接状态就变成了 "),_("font",{attrs:{color:"red"}},[v._v("SYN_RCVD")])],1),v._v(" "),_("li",[v._v("Client 收到 Server 的 ACK 后，Client 端的链接状态就变成了 "),_("font",{attrs:{color:"red"}},[v._v("ESTABLISHED")]),v._v(" 状态。同时，Client 向 Server 端发送 ACK，回复 Server 端的 SYN 请求。Client恢复 "),_("code",[v._v("seq=x+1")]),v._v("、"),_("code",[v._v("ack=y+1")]),v._v(" ，"),_("u",[v._v("Client为该TCP连接分配缓存和变量")])],1)]),v._v(" "),_("br"),v._v(" "),_("h2",{attrs:{id:"_3-浏览器向web服务器发送http请求"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-浏览器向web服务器发送http请求"}},[v._v("#")]),v._v(" 3. 浏览器向web服务器发送HTTP请求")]),v._v(" "),_("p",[v._v("TCP三次握手之后，开始发送HTTP请求报文至服务器")]),v._v(" "),_("p",[v._v("HTTP请求报文格式："),_("code",[v._v("请求行")]),v._v(" +  "),_("code",[v._v("请求头")]),v._v(" +  "),_("code",[v._v("空行")]),v._v(" + "),_("code",[v._v("消息体")])]),v._v(" "),_("p",[v._v("请求行包括请求方式（GET/POST/DELETE/PUT）、请求资源路径（URL）、HTTP版本号；")]),v._v(" "),_("p",[v._v("【默认GET请求，默认HTTP1.1，默认长连接"),_("code",[v._v("Connection:keep-alive")]),v._v("】")]),v._v(" "),_("p",[_("img",{attrs:{src:"8.%E8%BE%93%E5%85%A5URL%E5%88%B0%E8%B7%B3%E8%BD%AC.assets/1596589633888-92518967-0cbf-444c-bd80-fb46de3a2c7d.png",alt:"image"}})]),v._v(" "),_("br"),v._v(" "),_("h2",{attrs:{id:"_4-服务器处理请求并返回http报文"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4-服务器处理请求并返回http报文"}},[v._v("#")]),v._v(" 4. 服务器处理请求并返回HTTP报文")]),v._v(" "),_("p",[v._v("服务器收到请求后会发出应答，即响应数据。")]),v._v(" "),_("p",[v._v("HTTP响应报文格式："),_("code",[v._v("状态行")]),v._v(" + "),_("code",[v._v("响应头")]),v._v(" + "),_("code",[v._v("空行")]),v._v(" + "),_("code",[v._v("消息体")])]),v._v(" "),_("p",[v._v("状态行包括HTTP版本号、状态码、状态说明")]),v._v(" "),_("p",[_("img",{attrs:{src:"8.%E8%BE%93%E5%85%A5URL%E5%88%B0%E8%B7%B3%E8%BD%AC.assets/1596589633924-4eca950e-e285-473d-9730-a96e5773891a.png",alt:"image"}})]),v._v(" "),_("br"),v._v(" "),_("h2",{attrs:{id:"_5-浏览器解析渲染页面"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_5-浏览器解析渲染页面"}},[v._v("#")]),v._v(" 5. 浏览器解析渲染页面")]),v._v(" "),_("p",[v._v("浏览器拿到响应文本后，解析HTML代码，请求js，css等资源，最后进行页面渲染，呈现给用户。")]),v._v(" "),_("p",[v._v("页面渲染一般分为以下几个步骤：")]),v._v(" "),_("ol",[_("li",[v._v("根据HTML文件解析出DOM Tree")]),v._v(" "),_("li",[v._v("根据CSS解析出 CSSOM Tree(CSS规则树)")]),v._v(" "),_("li",[v._v("将 DOM Tree 和 CSSOM Tree合并，构建Render tree(渲染树)")]),v._v(" "),_("li",[v._v("reflow(重排)：根据Render tree进行节点信息计算（Layout）")]),v._v(" "),_("li",[v._v("repaint(重绘)：根据计算好的信息绘制整个页面（Painting）")])]),v._v(" "),_("p",[_("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626193503.png",alt:"DOM"}})]),v._v(" "),_("br"),v._v(" "),_("h2",{attrs:{id:"_6-tcp四次挥手断开连接"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_6-tcp四次挥手断开连接"}},[v._v("#")]),v._v(" 6. TCP四次挥手断开连接")]),v._v(" "),_("p",[_("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626193518.png",alt:""}})]),v._v(" "),_("p",[_("strong",[v._v("【挥手阶段】")])]),v._v(" "),_("ol",[_("li",[v._v("Client请求关闭连接。首先主动向Server发送一个 TCP 首部 "),_("code",[v._v("FIN=1")]),v._v(" 标志位为 的报文，Client随机选取一个序列号"),_("code",[v._v("seq=u")]),v._v("作为自己的初始序号发送给Server，之后客户端进入 "),_("code",[v._v("FIN_WAIT_1")]),v._v(" 状态。")]),v._v(" "),_("li",[v._v("Server回应"),_("code",[v._v("ACK")]),v._v("对Client的数据包进行确认，回复确认号"),_("code",[v._v("ack=u+1")]),v._v("，同时Server告诉Client自己的初始序列号"),_("code",[v._v("seq=v")]),v._v("；"),_("u",[v._v("客户到服务器这个方向的连接就成了一一半关闭 "),_("font",{attrs:{color:"red"}},[v._v("CLOSED_WAIT")]),v._v(" 状态")],1),v._v("。由于Server可能还与他客户端同时在通信，或者可能此时对A的数据没有发送完，这次不会回复"),_("code",[v._v("FIN")]),v._v("标志位。")]),v._v(" "),_("li",[v._v("第三条消息Server告诉Client可以断开连接，数据已传输完，。回复"),_("code",[v._v("FIN=1")]),v._v("，"),_("code",[v._v("ACK=1")]),v._v("确认。Server依然恢复第二次的确认号"),_("code",[v._v("ack=u+1")]),v._v("，因为这段时间A处于半关闭状态，并没有在发送数据 。并且回复"),_("code",[v._v("seq =v")]),_("u",[v._v("服务端进入 "),_("font",{attrs:{color:"red"}},[v._v("LAST_ACK")]),v._v("状态")],1)]),v._v(" "),_("li",[v._v("Clint收到Server的反馈后，回送"),_("code",[v._v("ACK=1")]),v._v("，由于要断开连接不再发送数据了，"),_("code",[v._v("seq=u+1")]),v._v("（序号为上次B回复A的ack），"),_("code",[v._v("ack=w+1")]),v._v("。发送完后Clinet进入 "),_("font",{attrs:{color:"blue"}},[_("strong",[v._v("TIME_WAIT")])]),v._v("状态。客户端在等待"),_("strong",[v._v("2MSL")]),v._v("后，确保Server收到第四条消息后，自动进入 "),_("font",{attrs:{color:"red"}},[v._v("CLOSE")]),v._v("状态。服务器收到第四条消息后进入了 "),_("font",{attrs:{color:"red"}},[v._v("CLOSE")]),v._v("状态。至此客户端也完成连接的关闭。")],1)])])}),[],!1,null,null,null);_.default=r.exports}}]);