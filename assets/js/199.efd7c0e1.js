(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{527:function(s,a,t){"use strict";t.r(a);var n=t(3),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_1-虚拟机栈概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-虚拟机栈概述"}},[s._v("#")]),s._v(" 1. 虚拟机栈概述")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200625092209.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"虚拟机栈出现背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟机栈出现背景"}},[s._v("#")]),s._v(" 虚拟机栈出现背景")]),s._v(" "),a("p",[s._v("由于跨平台性的设计，Java指令都是"),a("strong",[s._v("基于栈")]),s._v("（8位对齐）来设计的。不同平台的CPU架构不同，所以不能设计为基于寄存器的（16位为对齐）。")]),s._v(" "),a("p",[s._v("【基于栈的优势】：跨平台，指令集小，编译器容易实现；")]),s._v(" "),a("p",[s._v("【劣势】：相比基于寄存器的方式，性能下降，实现的同样的功能指令多")]),s._v(" "),a("h3",{attrs:{id:"内存中的栈与堆"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内存中的栈与堆"}},[s._v("#")]),s._v(" 内存中的栈与堆")]),s._v(" "),a("p",[a("font",{attrs:{color:"red"}},[a("strong",[s._v("栈是运行时的单位，堆是存储时的单位。")])])],1),s._v(" "),a("ul",[a("li",[a("p",[s._v("虚拟机栈解决程序的运行问题，程序执行最终都是压入虚拟机栈的栈帧中")])]),s._v(" "),a("li",[a("p",[s._v("堆解决的是数据存储问题，（除去基本类型之外）主体数据均是存储在堆上")])])]),s._v(" "),a("blockquote",[a("p",[s._v("就好比是我们电脑的内存和硬盘，程序的执行都需要加载到内存中来运行。但是保存数据都是持久化在硬盘上的，硬盘中的数据需要读取到内存中才能执行。")])]),s._v(" "),a("h3",{attrs:{id:"虚拟机栈的基本内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟机栈的基本内容"}},[s._v("#")]),s._v(" 虚拟机栈的基本内容")]),s._v(" "),a("p",[s._v("【作用】：管理Java程序的运行，保存方法的局部变量、部分结果，参与方法的调用和返回")]),s._v(" "),a("p",[s._v("【生命周期】：与线程的生命周期相同")]),s._v(" "),a("p",[s._v("【特点】")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("访问速度仅次于PC计数器（只涉及到入栈和出栈的操作）")])]),s._v(" "),a("li",[a("p",[s._v("不存在垃圾回收问题")])])]),s._v(" "),a("blockquote",[a("p",[s._v("会存在OOM和StackOverflow")])]),s._v(" "),a("h3",{attrs:{id:"出现的异常"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#出现的异常"}},[s._v("#")]),s._v(" 出现的异常")]),s._v(" "),a("p",[s._v("Java虚拟机规范允许"),a("font",{attrs:{color:"red"}},[s._v("Java栈的大小是动态的或者固定不变的")])],1),s._v(" "),a("p",[s._v("《Java虚拟机规范》中规定了两类异常状况：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("如果线程请求的栈的深度大于虚拟机所允许的最大深度，抛出"),a("code",[s._v("StackOverflowError")])])]),s._v(" "),a("li",[a("p",[s._v("如果Java虚拟机栈可以动态扩展，并且在尝试扩展的时候无法中请到足够的内存，或者在"),a("strong",[s._v("创建新的线程时")]),s._v("没有足够的内存去创建对应的虚拟机栈，那JVM将会抛出"),a("code",[s._v("OutOfMemoryError")]),s._v("异常")])])]),s._v(" "),a("blockquote",[a("p",[s._v("HotSpot虚拟机栈容量不可以动态扩展，但是申请失败（并未拓展）仍会产生OOM，就是在创建新的线程时，已经没有足够内存为其分配空间来创建。")])]),s._v(" "),a("p",[s._v("【手动设置虚拟机栈的容量大小】")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("-Xss256k")]),s._v("（单位为k、m、g，忽略大小写）")])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"_2-虚拟机栈的内部结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-虚拟机栈的内部结构"}},[s._v("#")]),s._v(" 2. 虚拟机栈的内部结构")]),s._v(" "),a("h3",{attrs:{id:"栈中存储什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#栈中存储什么"}},[s._v("#")]),s._v(" 栈中存储什么")]),s._v(" "),a("p",[s._v("虚拟机栈的基本单元是"),a("strong",[s._v("栈帧")]),s._v("（Stack Frame），一个栈帧对应一个Java方法的调用")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200625150543.png",alt:""}})]),s._v(" "),a("p",[s._v("【执行原理】")]),s._v(" "),a("p",[s._v("由于虚拟机栈是线程私有的，不同的线程有不同的栈，不同的栈之间数据不能共享。即不可能存在一个栈帧中引用另外一个线程的栈帧。它们可以通过同一个进程来共享数据。")]),s._v(" "),a("p",[a("strong",[s._v("Java方法有两种返回函数的方式：")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("一种是正常的函数返回，使用"),a("code",[s._v("return")]),s._v("指令；")])]),s._v(" "),a("li",[a("p",[s._v("另外一种是抛出异常")])])]),s._v(" "),a("blockquote",[a("p",[s._v("不管使用哪种方式，都会导致栈帧被弹出")])]),s._v(" "),a("h3",{attrs:{id:"栈帧的内部数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#栈帧的内部数据"}},[s._v("#")]),s._v(" 栈帧的内部数据")]),s._v(" "),a("p",[a("strong",[s._v("每个栈帧中存储着5部分数据：")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200625173710.png",alt:""}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("局部变量表（Local Variables）")])]),s._v(" "),a("li",[a("p",[s._v("操作数栈（Operand Stack）")])]),s._v(" "),a("li",[a("p",[s._v("动态链接（Dynamic Linking）")])]),s._v(" "),a("li",[a("p",[s._v("方法返回地址（Return Address）")])]),s._v(" "),a("li",[a("p",[s._v("附加信息")])])]),s._v(" "),a("p",[s._v("接下来，我们分别讨论这5部分的作用")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"_3-局部变量表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-局部变量表"}},[s._v("#")]),s._v(" 3. 局部变量表")]),s._v(" "),a("p",[s._v("局部变量表Local Variables（局部变量数组或者本地变量表）。")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("局部变量表是一个"),a("font",{attrs:{color:"pink"}},[s._v("数字数组")]),s._v("，主要用于存储方法参数 和 定义在方法体内的局部变量。")],1),s._v(" "),a("ul",[a("li",[s._v("数据类型包括：基本数据类型、引用类型、返回值类型")])])]),s._v(" "),a("li",[a("p",[s._v("线程私有数据，不存在线程安全问题")])]),s._v(" "),a("li",[a("p",[s._v("局部变量表的容量大小在"),a("font",{attrs:{color:"pink"}},[s._v("编译期间")]),s._v("被确定，在方法运行期间不会改变（数组）")],1)])]),s._v(" "),a("p",[s._v("使用 jclasslib插件查看out包下反编译后的字节码文件")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200625191813.png",alt:""}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200625192601.png",alt:""}})]),s._v(" "),a("p",[s._v("main方法对应的字节码文件")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" #"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("iqqcode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jvmstack"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariablesTest01")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" dup\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" invokespecial #"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("iqqcode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jvmstack"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariablesTest01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" astore_1\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" bipush "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" istore_2\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" aload_1\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" invokevirtual #"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("iqqcode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jvmstack"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariablesTest01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("test1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("iqqcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jvmstack")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @Author: Mr.Q\n * @Date: 2020-06-25 09:39\n * @Description:局部变量表容量测试\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariablesTest01")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" count "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariablesTest01")]),s._v(" test "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariablesTest01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" num "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("test1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("testStatic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariablesTest01")]),s._v(" test "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariablesTest01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")]),s._v(" date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" count "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//因为this变量不存在于当前方法的局部变量表中！！")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//System.out.println(this.count);")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//关于Slot的使用的理解")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariablesTest01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("test1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")]),s._v(" date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" name1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"iqqcode"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("test2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" name1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("test2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")]),s._v(" dateP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" name2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        dateP "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        name2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mr.Q"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("double")]),s._v(" weight "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("130.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//占据两个slot")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" gender "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token char"}},[s._v("'男'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" dateP "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" name2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("test3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("test4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            b "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//变量c使用之前已经销毁的变量b占据的slot的位置")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" c "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("test5Temp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//System.out.println(num);//错误信息：变量num未进行初始化")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br")])]),a("p",[a("strong",[s._v("槽Slot：")])]),s._v(" "),a("p",[s._v("数字数组中存放法的数据类型包括：基本数据类型（boolean、byte、char、short、int、float、long、double）、引用类型（reference引用指针类型）、返回值类型（returnAddress指向字节码指令的地址）")]),s._v(" "),a("p",[s._v("局部变量表所需的内存空间在编译期间完成分配，当进入一个方法时，这个方法需要在帧中分配多大的局部变量空间是完全确定的，在方法运行期间不会改变局部变量表的大小。")]),s._v(" "),a("blockquote",[a("p",[s._v("局部变量表和操作数栈底层都是采用数组实现的，所以一旦初始化后，长度是固定不变的")])]),s._v(" "),a("p",[s._v("这些数据类型在局部变量表中的存储空间用局部 **变量槽（Slot）**来表示，"),a("code",[s._v("long")]),s._v("和"),a("code",[s._v("double")]),s._v("是64位占两个槽，其余占一个。")]),s._v(" "),a("blockquote",[a("p",[s._v("所以局部变量表的容量就是槽的个数，在编译期间就是确定的")])]),s._v(" "),a("p",[a("mark",[a("strong",[s._v("变量的分类：")])])]),s._v(" "),a("p",[s._v("一、按照数据类型分：① 基本数据类型  ② 引用数据类型")]),s._v(" "),a("p",[s._v("二、按照在类中声明的位置分：")]),s._v(" "),a("p",[s._v("① 成员变量：在使用前，都经历过默认初始化赋值")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("类变量： Linking的"),a("code",[s._v("Prepare")]),s._v("阶段：给类变量默认赋值 ====> initial阶段：给类变量显式赋值")])]),s._v(" "),a("li",[a("p",[s._v("实例变量：随着对象的创建，会在堆空间中分配实例变量空间，并进行默认赋值")])])]),s._v(" "),a("p",[s._v("② 局部变量：在使用前，必须要进行显式赋值的！否则，编译不通过")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"_4-操作数栈"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-操作数栈"}},[s._v("#")]),s._v(" 4. 操作数栈")]),s._v(" "),a("p",[s._v("栈帧中存储的第二部分数据----操作数栈Operand Stack（也称表达式栈）。")]),s._v(" "),a("p",[a("strong",[s._v("主要用来保存计算过程的中间结果，同时作为计算过程中 变量临时的存储空间。")])]),s._v(" "),a("p",[s._v("操作数栈对于数据的存储跟局部变量表是一样的，但是跟局部变量表不同的是，操作数栈对于数据的访问不是通过下标，而是"),a("strong",[s._v("通过标准的栈操作来进行的（压入与弹出）")])]),s._v(" "),a("p",[s._v("对于数据的计算是由CPU完成的，所以CPU在执行指令时每次会从操作数栈中弹出所需的操作数，经过计算后再压入到操作数栈顶。")]),s._v(" "),a("blockquote",[a("p",[s._v("另外，我们说Java虚拟机的解释引擎是基于栈的执行引擎，其中的栈指的就是操作数栈。")])]),s._v(" "),a("p",[s._v("我们通过一个例子来进行代码追踪分析：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PCRegisterTest")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" j "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" k "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" j"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("反编译之后的主体代码：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("iqqcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pcregister"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("PCRegisterTest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    descriptor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),s._v("\n    flags"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ACC_PUBLIC")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Code")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      stack"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" locals"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args_size"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" aload_0\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" invokespecial #"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// Method java/lang/Object."<init>":()V')]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LineNumberTable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        line "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariableTable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Start")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Length")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Slot")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Name")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Signature")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Liqqcode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("pcregister"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PCRegisterTest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    descriptor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ljava")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),s._v("\n    flags"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ACC_PUBLIC")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ACC_STATIC")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Code")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      stack"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" locals"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args_size"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" bipush        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" istore_1\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" bipush        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" istore_2\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" iload_1\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" iload_2\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" iadd\n         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" istore_3\n        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LineNumberTable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        line "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        line "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n        line "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n        line "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalVariableTable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Start")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Length")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Slot")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Name")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Signature")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  args   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ljava")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     i   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("     j   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("     k   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SourceFile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PCRegisterTest.java"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br")])]),a("p",[s._v("我们对代码进行跟踪分析")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626160202.png",alt:""}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626160256.png",alt:""}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626153841.png",alt:""}})]),s._v(" "),a("p",[s._v("对照字节码指令，我们逐行分析：")]),s._v(" "),a("p",[s._v("初始情况")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626173734.png",alt:""}})]),s._v(" "),a("p",[s._v("I. 根据PC计数器记录的代码偏移位置0，操作数10入栈")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626173811.png",alt:""}})]),s._v(" "),a("p",[s._v("II. 根据PC计数器记录的代码偏移位置2，操作数10出栈放入到局部变量表中索引为1的位置处")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626173841.png",alt:""}})]),s._v(" "),a("p",[s._v("III. 根据PC计数器记录的代码偏移位置3，操作数20入栈")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626173955.png",alt:""}})]),s._v(" "),a("p",[s._v("IV. 根据PC计数器记录的代码偏移位置5，操作数20出栈放入到局部变量表中索引为2的位置处")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626174009.png",alt:""}})]),s._v(" "),a("p",[s._v("V. 从局部变量表中取出索引1位置的数(10)，放入到操作数栈中")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626174030.png",alt:""}})]),s._v(" "),a("p",[s._v("VI. 从局部变量表中取出索引2位置的数(20)，放入到操作数栈中")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626174049.png",alt:""}})]),s._v(" "),a("p",[s._v("VII. 将两个操作数出栈相加后加过再入栈")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626174108.png",alt:""}})]),s._v(" "),a("p",[s._v("VIII. 操作数30放入局部变量表索引为3的位置处")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200626174247.png",alt:""}})]),s._v(" "),a("p",[s._v("IX. 方法结束返回（返回为空）")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"_5-动态链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-动态链接"}},[s._v("#")]),s._v(" 5. 动态链接")]),s._v(" "),a("p",[a("strong",[s._v("动态链接、方法返回地址、附加信息统称为帧数据区")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200628130131.png",alt:""}})]),s._v(" "),a("p",[s._v("动态链接Dynaminc Linking（或"),a("strong",[s._v("指向"),a("mark",[s._v("运行时常量池")]),s._v("的方法引用")]),s._v("）。")]),s._v(" "),a("p",[s._v("在Java源文件被编译成字节码文件时，所有的变量和方法引用都作为符号引用（Sysmbolic Reference） 保存到class文件的 常量池中。描述一个方法调用了其他方法时，就是通过常量池中指向方法的符号引用来表示的。")]),s._v(" "),a("p",[a("strong",[s._v("动态链接的作用就是为了将符号引用转换为直接引用")])]),s._v(" "),a("p",[a("strong",[s._v("【符号引用与直接引用】")])]),s._v(" "),a("ul",[a("li",[s._v("符号引用就是常量池中的一个字符串")]),s._v(" "),a("li",[s._v("直接引用是指向方法的真正的入口")])]),s._v(" "),a("p",[s._v("这不就和类加载系统中链接阶段的解析Resolve过程类似么😒！")]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("解析Resolve")]),s._v("：将"),a("mark",[s._v("常量池")]),s._v("内的符号引用转为直接引用的过程")])]),s._v(" "),a("p",[s._v("我们是先通过类加器将类加载到内存中，此时class文件中便存在了常量池Constant Pool。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200628092126.png",alt:""}})]),s._v(" "),a("p",[s._v("编译之后生成的"),a("code",[s._v(".class")]),s._v("文件的常量池中存在着大量的符号引用")]),s._v(" "),a("ul",[a("li",[s._v("这些符号引用"),a("strong",[s._v("一部分在类加载过程的解析阶段被JVM转化为直接引用")]),s._v("，这个过程就被称为解析（静态解析）")]),s._v(" "),a("li",[s._v("而"),a("strong",[s._v("剩下的一部分符号引用在每一次运行的时候在运行时常量池中被JVM转化为直接引用")]),s._v("，这个过程被称为动态连接")])]),s._v(" "),a("p",[s._v("区别就是")]),s._v(" "),a("ol",[a("li",[a("font",{attrs:{color:"[[E86262]]"}},[s._v("【位置不同】")])],1)]),s._v(" "),a("ul",[a("li",[s._v("动态链接指向的是"),a("strong",[s._v("方法区的运行时常量池")])]),s._v(" "),a("li",[s._v("解析指向的是"),a("strong",[s._v("class文件中的常量池")])])]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("font",{attrs:{color:"[[E86262]]"}},[s._v("【时间不同】")])],1)]),s._v(" "),a("ul",[a("li",[s._v("动态链接是在字节码解释执行时")]),s._v(" "),a("li",[s._v("解析是在类加载时")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200628092307.png",alt:""}})]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"_6-方法返回地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-方法返回地址"}},[s._v("#")]),s._v(" 6. 方法返回地址")]),s._v(" "),a("p",[s._v("方法返回地址Return Address，存放该方法的PC寄存器的值")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img/20200628130131.png",alt:""}})]),s._v(" "),a("p",[s._v("一个方法的结束，有两种方式：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("正常执行完成")])]),s._v(" "),a("li",[a("p",[s._v("出现未处理的异常，非正常退出")])])]),s._v(" "),a("p",[s._v("方法正常退出，方法调用者的PC寄存器的值作为返回地址；")]),s._v(" "),a("p",[s._v("方法异常结束，返回地址通过异常表来确定，栈帧中不会存储这部分信息")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"_7-附加信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-附加信息"}},[s._v("#")]),s._v(" 7. 附加信息")]),s._v(" "),a("p",[s._v("栈帧中还允许携带与Java虚拟机实现相关的一些附加信息。例如，对程序调试提供支持的信息。")])])}),[],!1,null,null,null);a.default=e.exports}}]);