<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å…¨åŒå·¥é€šè®¯çš„WebSocketåè®® | icode</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="webå‰ç«¯æŠ€æœ¯åšå®¢,ç®€æ´è‡³ä¸Š,ä¸“æ³¨webå‰ç«¯å­¦ä¹ ä¸æ€»ç»“ã€‚JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,githubç­‰æŠ€æœ¯æ–‡ç« ã€‚">
    <meta name="keywords" content="iqqcodeä¸ªäººæŠ€æœ¯åšå®¢,Androidå¼€å‘,è®¡ç®—æœºåŸºç¡€çŸ¥è¯†,Javaåç«¯,Androidé¢è¯•é¢˜,æŠ€æœ¯æ–‡æ¡£,å­¦ä¹ ,é¢è¯•,Java,Kotlin,Android,Android UI,python,Git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.ceb4cb47.css" as="style"><link rel="preload" href="/assets/js/app.c4fffd9b.js" as="script"><link rel="preload" href="/assets/js/2.9f83a926.js" as="script"><link rel="preload" href="/assets/js/403.c1141a30.js" as="script"><link rel="prefetch" href="/assets/js/10.35c68bd0.js"><link rel="prefetch" href="/assets/js/100.90029d0b.js"><link rel="prefetch" href="/assets/js/101.d3a4a836.js"><link rel="prefetch" href="/assets/js/102.a727386c.js"><link rel="prefetch" href="/assets/js/103.bc3fb8dc.js"><link rel="prefetch" href="/assets/js/104.9bfa15e7.js"><link rel="prefetch" href="/assets/js/105.cdcf3a6f.js"><link rel="prefetch" href="/assets/js/106.6bad5396.js"><link rel="prefetch" href="/assets/js/107.4d3eef3f.js"><link rel="prefetch" href="/assets/js/108.86b992c6.js"><link rel="prefetch" href="/assets/js/109.8a12806a.js"><link rel="prefetch" href="/assets/js/11.a1e4f728.js"><link rel="prefetch" href="/assets/js/110.6fcaaa50.js"><link rel="prefetch" href="/assets/js/111.cb6ed118.js"><link rel="prefetch" href="/assets/js/112.06fd92bb.js"><link rel="prefetch" href="/assets/js/113.5f32a60d.js"><link rel="prefetch" href="/assets/js/114.95abdc5b.js"><link rel="prefetch" href="/assets/js/115.ed9bd926.js"><link rel="prefetch" href="/assets/js/116.2cac1d58.js"><link rel="prefetch" href="/assets/js/117.83a57bca.js"><link rel="prefetch" href="/assets/js/118.57515045.js"><link rel="prefetch" href="/assets/js/119.7600fea0.js"><link rel="prefetch" href="/assets/js/12.5a87478f.js"><link rel="prefetch" href="/assets/js/120.c74a52a0.js"><link rel="prefetch" href="/assets/js/121.7e1c0bdd.js"><link rel="prefetch" href="/assets/js/122.0be034a9.js"><link rel="prefetch" href="/assets/js/123.1be06ae4.js"><link rel="prefetch" href="/assets/js/124.8541e25e.js"><link rel="prefetch" href="/assets/js/125.a1a7e6d1.js"><link rel="prefetch" href="/assets/js/126.c2bb4416.js"><link rel="prefetch" href="/assets/js/127.268b10c1.js"><link rel="prefetch" href="/assets/js/128.9c0f2ae5.js"><link rel="prefetch" href="/assets/js/129.12aab14b.js"><link rel="prefetch" href="/assets/js/13.9eb96038.js"><link rel="prefetch" href="/assets/js/130.98cacaf5.js"><link rel="prefetch" href="/assets/js/131.2345cb8f.js"><link rel="prefetch" href="/assets/js/132.7db7293c.js"><link rel="prefetch" href="/assets/js/133.7f46cc1e.js"><link rel="prefetch" href="/assets/js/134.5c48b209.js"><link rel="prefetch" href="/assets/js/135.8b7f0f3f.js"><link rel="prefetch" href="/assets/js/136.f2ed8038.js"><link rel="prefetch" href="/assets/js/137.a7b6de88.js"><link rel="prefetch" href="/assets/js/138.0e892244.js"><link rel="prefetch" href="/assets/js/139.cc2a4fe5.js"><link rel="prefetch" href="/assets/js/14.de3651da.js"><link rel="prefetch" href="/assets/js/140.9c4150d0.js"><link rel="prefetch" href="/assets/js/141.e00b8913.js"><link rel="prefetch" href="/assets/js/142.55fe8f39.js"><link rel="prefetch" href="/assets/js/143.380e795b.js"><link rel="prefetch" href="/assets/js/144.b892c909.js"><link rel="prefetch" href="/assets/js/145.48e9e594.js"><link rel="prefetch" href="/assets/js/146.1909038d.js"><link rel="prefetch" href="/assets/js/147.f81a66fb.js"><link rel="prefetch" href="/assets/js/148.fb68c2e3.js"><link rel="prefetch" href="/assets/js/149.5a794e49.js"><link rel="prefetch" href="/assets/js/15.9cc8357f.js"><link rel="prefetch" href="/assets/js/150.870a3a84.js"><link rel="prefetch" href="/assets/js/151.67613ad8.js"><link rel="prefetch" href="/assets/js/152.eb9a6177.js"><link rel="prefetch" href="/assets/js/153.2742ce68.js"><link rel="prefetch" href="/assets/js/154.29650726.js"><link rel="prefetch" href="/assets/js/155.a4a4e09e.js"><link rel="prefetch" href="/assets/js/156.c89921ba.js"><link rel="prefetch" href="/assets/js/157.4b583e23.js"><link rel="prefetch" href="/assets/js/158.200d5c17.js"><link rel="prefetch" href="/assets/js/159.8e38aae7.js"><link rel="prefetch" href="/assets/js/16.f44bd57c.js"><link rel="prefetch" href="/assets/js/160.8f6a94ab.js"><link rel="prefetch" href="/assets/js/161.da1a4a22.js"><link rel="prefetch" href="/assets/js/162.53662266.js"><link rel="prefetch" href="/assets/js/163.6230fe0f.js"><link rel="prefetch" href="/assets/js/164.3fc004f1.js"><link rel="prefetch" href="/assets/js/165.7de0f4a6.js"><link rel="prefetch" href="/assets/js/166.ecca032e.js"><link rel="prefetch" href="/assets/js/167.e1018c98.js"><link rel="prefetch" href="/assets/js/168.a7b1869a.js"><link rel="prefetch" href="/assets/js/169.72667f5d.js"><link rel="prefetch" href="/assets/js/17.39d5e4ad.js"><link rel="prefetch" href="/assets/js/170.b95bf15a.js"><link rel="prefetch" href="/assets/js/171.9c045011.js"><link rel="prefetch" href="/assets/js/172.d4720e4e.js"><link rel="prefetch" href="/assets/js/173.96fbff3b.js"><link rel="prefetch" href="/assets/js/174.31dbd100.js"><link rel="prefetch" href="/assets/js/175.66bff00d.js"><link rel="prefetch" href="/assets/js/176.a811fba7.js"><link rel="prefetch" href="/assets/js/177.a1acb18f.js"><link rel="prefetch" href="/assets/js/178.a13da04f.js"><link rel="prefetch" href="/assets/js/179.70b45d97.js"><link rel="prefetch" href="/assets/js/18.c4df36af.js"><link rel="prefetch" href="/assets/js/180.cb8e96c1.js"><link rel="prefetch" href="/assets/js/181.5bc25898.js"><link rel="prefetch" href="/assets/js/182.914c3d49.js"><link rel="prefetch" href="/assets/js/183.cdee2109.js"><link rel="prefetch" href="/assets/js/184.a4a94f17.js"><link rel="prefetch" href="/assets/js/185.53c0dc11.js"><link rel="prefetch" href="/assets/js/186.ae181b5e.js"><link rel="prefetch" href="/assets/js/187.4a131e58.js"><link rel="prefetch" href="/assets/js/188.3f0c3f36.js"><link rel="prefetch" href="/assets/js/189.735dd8f4.js"><link rel="prefetch" href="/assets/js/19.8b20b983.js"><link rel="prefetch" href="/assets/js/190.b715ee6b.js"><link rel="prefetch" href="/assets/js/191.1a21480c.js"><link rel="prefetch" href="/assets/js/192.f1a764e7.js"><link rel="prefetch" href="/assets/js/193.a5b89957.js"><link rel="prefetch" href="/assets/js/194.4387950a.js"><link rel="prefetch" href="/assets/js/195.a65d434d.js"><link rel="prefetch" href="/assets/js/196.bb7b9cc4.js"><link rel="prefetch" href="/assets/js/197.0965e3ef.js"><link rel="prefetch" href="/assets/js/198.db6cc7b3.js"><link rel="prefetch" href="/assets/js/199.efd7c0e1.js"><link rel="prefetch" href="/assets/js/20.56028c13.js"><link rel="prefetch" href="/assets/js/200.740e0229.js"><link rel="prefetch" href="/assets/js/201.3aeee16c.js"><link rel="prefetch" href="/assets/js/202.cb2c5cc3.js"><link rel="prefetch" href="/assets/js/203.53493d70.js"><link rel="prefetch" href="/assets/js/204.b0455d4f.js"><link rel="prefetch" href="/assets/js/205.5be45085.js"><link rel="prefetch" href="/assets/js/206.638f016a.js"><link rel="prefetch" href="/assets/js/207.3aed7b71.js"><link rel="prefetch" href="/assets/js/208.9968d45e.js"><link rel="prefetch" href="/assets/js/209.43dda282.js"><link rel="prefetch" href="/assets/js/21.cb9ec569.js"><link rel="prefetch" href="/assets/js/210.562cae7a.js"><link rel="prefetch" href="/assets/js/211.f6990922.js"><link rel="prefetch" href="/assets/js/212.4160ee69.js"><link rel="prefetch" href="/assets/js/213.51929c5d.js"><link rel="prefetch" href="/assets/js/214.55f87ee8.js"><link rel="prefetch" href="/assets/js/215.5cf2688f.js"><link rel="prefetch" href="/assets/js/216.fa3f6e08.js"><link rel="prefetch" href="/assets/js/217.030e1227.js"><link rel="prefetch" href="/assets/js/218.0b65ded2.js"><link rel="prefetch" href="/assets/js/219.24e0a3e2.js"><link rel="prefetch" href="/assets/js/22.4d680d57.js"><link rel="prefetch" href="/assets/js/220.acb78f61.js"><link rel="prefetch" href="/assets/js/221.7155683c.js"><link rel="prefetch" href="/assets/js/222.dfe2f66a.js"><link rel="prefetch" href="/assets/js/223.43dcc775.js"><link rel="prefetch" href="/assets/js/224.478f37dd.js"><link rel="prefetch" href="/assets/js/225.c66e7675.js"><link rel="prefetch" href="/assets/js/226.52132969.js"><link rel="prefetch" href="/assets/js/227.007e41ac.js"><link rel="prefetch" href="/assets/js/228.5df8ae2b.js"><link rel="prefetch" href="/assets/js/229.36696c6e.js"><link rel="prefetch" href="/assets/js/23.c61706fd.js"><link rel="prefetch" href="/assets/js/230.5f013e25.js"><link rel="prefetch" href="/assets/js/231.2d867015.js"><link rel="prefetch" href="/assets/js/232.f0dc43b6.js"><link rel="prefetch" href="/assets/js/233.30b764c1.js"><link rel="prefetch" href="/assets/js/234.5469a470.js"><link rel="prefetch" href="/assets/js/235.931c5096.js"><link rel="prefetch" href="/assets/js/236.3efa0639.js"><link rel="prefetch" href="/assets/js/237.df6eeb81.js"><link rel="prefetch" href="/assets/js/238.86870cd9.js"><link rel="prefetch" href="/assets/js/239.0dea9f43.js"><link rel="prefetch" href="/assets/js/24.34b0677f.js"><link rel="prefetch" href="/assets/js/240.2a1ba3eb.js"><link rel="prefetch" href="/assets/js/241.a432633f.js"><link rel="prefetch" href="/assets/js/242.930a9ae0.js"><link rel="prefetch" href="/assets/js/243.ba2f54e1.js"><link rel="prefetch" href="/assets/js/244.baf03f3a.js"><link rel="prefetch" href="/assets/js/245.bbb30308.js"><link rel="prefetch" href="/assets/js/246.d8220e2c.js"><link rel="prefetch" href="/assets/js/247.0d603794.js"><link rel="prefetch" href="/assets/js/248.7157409f.js"><link rel="prefetch" href="/assets/js/249.946ae3ae.js"><link rel="prefetch" href="/assets/js/25.7fe03aa6.js"><link rel="prefetch" href="/assets/js/250.08256dc2.js"><link rel="prefetch" href="/assets/js/251.d963de19.js"><link rel="prefetch" href="/assets/js/252.37750e79.js"><link rel="prefetch" href="/assets/js/253.cf32370d.js"><link rel="prefetch" href="/assets/js/254.34f6e896.js"><link rel="prefetch" href="/assets/js/255.56a6d6e9.js"><link rel="prefetch" href="/assets/js/256.c6fdb820.js"><link rel="prefetch" href="/assets/js/257.ce6a0cac.js"><link rel="prefetch" href="/assets/js/258.2a100981.js"><link rel="prefetch" href="/assets/js/259.dac64042.js"><link rel="prefetch" href="/assets/js/26.edbdf302.js"><link rel="prefetch" href="/assets/js/260.769008f3.js"><link rel="prefetch" href="/assets/js/261.0d396fd2.js"><link rel="prefetch" href="/assets/js/262.09f85e25.js"><link rel="prefetch" href="/assets/js/263.4c7a3bcd.js"><link rel="prefetch" href="/assets/js/264.db180a43.js"><link rel="prefetch" href="/assets/js/265.cc07c5f1.js"><link rel="prefetch" href="/assets/js/266.55b1d837.js"><link rel="prefetch" href="/assets/js/267.25065a31.js"><link rel="prefetch" href="/assets/js/268.bebd196a.js"><link rel="prefetch" href="/assets/js/269.497125cb.js"><link rel="prefetch" href="/assets/js/27.467a6179.js"><link rel="prefetch" href="/assets/js/270.01119896.js"><link rel="prefetch" href="/assets/js/271.92babc4c.js"><link rel="prefetch" href="/assets/js/272.4f8f8723.js"><link rel="prefetch" href="/assets/js/273.b032f89e.js"><link rel="prefetch" href="/assets/js/274.24f82320.js"><link rel="prefetch" href="/assets/js/275.870fff68.js"><link rel="prefetch" href="/assets/js/276.656145f5.js"><link rel="prefetch" href="/assets/js/277.4e823ccb.js"><link rel="prefetch" href="/assets/js/278.74c4b649.js"><link rel="prefetch" href="/assets/js/279.c15e38a3.js"><link rel="prefetch" href="/assets/js/28.19f83fa5.js"><link rel="prefetch" href="/assets/js/280.1f00b03b.js"><link rel="prefetch" href="/assets/js/281.5f7e9149.js"><link rel="prefetch" href="/assets/js/282.886a0af3.js"><link rel="prefetch" href="/assets/js/283.c6c6fab5.js"><link rel="prefetch" href="/assets/js/284.9edef1d1.js"><link rel="prefetch" href="/assets/js/285.dc3a5432.js"><link rel="prefetch" href="/assets/js/286.138bef72.js"><link rel="prefetch" href="/assets/js/287.f76e370f.js"><link rel="prefetch" href="/assets/js/288.78c2980b.js"><link rel="prefetch" href="/assets/js/289.ec0893c0.js"><link rel="prefetch" href="/assets/js/29.6b9a37af.js"><link rel="prefetch" href="/assets/js/290.cc9e0935.js"><link rel="prefetch" href="/assets/js/291.8ced75e3.js"><link rel="prefetch" href="/assets/js/292.053648f2.js"><link rel="prefetch" href="/assets/js/293.0b8824b2.js"><link rel="prefetch" href="/assets/js/294.734997d8.js"><link rel="prefetch" href="/assets/js/295.3e11be76.js"><link rel="prefetch" href="/assets/js/296.6450d200.js"><link rel="prefetch" href="/assets/js/297.8f3a33db.js"><link rel="prefetch" href="/assets/js/298.c956c547.js"><link rel="prefetch" href="/assets/js/299.6b94a182.js"><link rel="prefetch" href="/assets/js/3.f761a838.js"><link rel="prefetch" href="/assets/js/30.386e021a.js"><link rel="prefetch" href="/assets/js/300.bcfc8f68.js"><link rel="prefetch" href="/assets/js/301.87eecddb.js"><link rel="prefetch" href="/assets/js/302.30c8944c.js"><link rel="prefetch" href="/assets/js/303.bf7fb9ce.js"><link rel="prefetch" href="/assets/js/304.b2262ab2.js"><link rel="prefetch" href="/assets/js/305.44e232f5.js"><link rel="prefetch" href="/assets/js/306.5d2b7ffa.js"><link rel="prefetch" href="/assets/js/307.9f31c9b9.js"><link rel="prefetch" href="/assets/js/308.7ff47fdb.js"><link rel="prefetch" href="/assets/js/309.6c4aa72f.js"><link rel="prefetch" href="/assets/js/31.6c065972.js"><link rel="prefetch" href="/assets/js/310.2dd6a183.js"><link rel="prefetch" href="/assets/js/311.8d1cffab.js"><link rel="prefetch" href="/assets/js/312.07c6f635.js"><link rel="prefetch" href="/assets/js/313.a3216bc7.js"><link rel="prefetch" href="/assets/js/314.f6f9f3b7.js"><link rel="prefetch" href="/assets/js/315.8c803181.js"><link rel="prefetch" href="/assets/js/316.66f99d15.js"><link rel="prefetch" href="/assets/js/317.27276d98.js"><link rel="prefetch" href="/assets/js/318.82d40360.js"><link rel="prefetch" href="/assets/js/319.de3a362a.js"><link rel="prefetch" href="/assets/js/32.84c9ff75.js"><link rel="prefetch" href="/assets/js/320.8bfa4101.js"><link rel="prefetch" href="/assets/js/321.4bcee5bd.js"><link rel="prefetch" href="/assets/js/322.c7bca23d.js"><link rel="prefetch" href="/assets/js/323.d9790358.js"><link rel="prefetch" href="/assets/js/324.6cd9ebf7.js"><link rel="prefetch" href="/assets/js/325.0262b0e8.js"><link rel="prefetch" href="/assets/js/326.7aa599e0.js"><link rel="prefetch" href="/assets/js/327.07d10552.js"><link rel="prefetch" href="/assets/js/328.21e79c11.js"><link rel="prefetch" href="/assets/js/329.b99baa18.js"><link rel="prefetch" href="/assets/js/33.d26609c0.js"><link rel="prefetch" href="/assets/js/330.f8e23d39.js"><link rel="prefetch" href="/assets/js/331.3e42539e.js"><link rel="prefetch" href="/assets/js/332.5310bf8f.js"><link rel="prefetch" href="/assets/js/333.7397ddfb.js"><link rel="prefetch" href="/assets/js/334.58bfa4df.js"><link rel="prefetch" href="/assets/js/335.e81da0ef.js"><link rel="prefetch" href="/assets/js/336.e3893cd1.js"><link rel="prefetch" href="/assets/js/337.9836527e.js"><link rel="prefetch" href="/assets/js/338.14b79adb.js"><link rel="prefetch" href="/assets/js/339.6f37c4c7.js"><link rel="prefetch" href="/assets/js/34.025a1886.js"><link rel="prefetch" href="/assets/js/340.493519a3.js"><link rel="prefetch" href="/assets/js/341.cc5047d3.js"><link rel="prefetch" href="/assets/js/342.a2d40ca4.js"><link rel="prefetch" href="/assets/js/343.99a1b5f2.js"><link rel="prefetch" href="/assets/js/344.221ddc73.js"><link rel="prefetch" href="/assets/js/345.0078be11.js"><link rel="prefetch" href="/assets/js/346.b49c191d.js"><link rel="prefetch" href="/assets/js/347.c8756936.js"><link rel="prefetch" href="/assets/js/348.d5c6fc58.js"><link rel="prefetch" href="/assets/js/349.b0440c29.js"><link rel="prefetch" href="/assets/js/35.52fa0766.js"><link rel="prefetch" href="/assets/js/350.a12ad7d3.js"><link rel="prefetch" href="/assets/js/351.c5f28d09.js"><link rel="prefetch" href="/assets/js/352.2b2a29c3.js"><link rel="prefetch" href="/assets/js/353.1353338b.js"><link rel="prefetch" href="/assets/js/354.f5a55086.js"><link rel="prefetch" href="/assets/js/355.74f419ac.js"><link rel="prefetch" href="/assets/js/356.b238d52b.js"><link rel="prefetch" href="/assets/js/357.66d3ef13.js"><link rel="prefetch" href="/assets/js/358.39e9b3c6.js"><link rel="prefetch" href="/assets/js/359.de2e8673.js"><link rel="prefetch" href="/assets/js/36.b19941a9.js"><link rel="prefetch" href="/assets/js/360.7c6a09c1.js"><link rel="prefetch" href="/assets/js/361.333022d4.js"><link rel="prefetch" href="/assets/js/362.a29e1f99.js"><link rel="prefetch" href="/assets/js/363.89f3677d.js"><link rel="prefetch" href="/assets/js/364.ab1b9569.js"><link rel="prefetch" href="/assets/js/365.6d755256.js"><link rel="prefetch" href="/assets/js/366.cf2dcd95.js"><link rel="prefetch" href="/assets/js/367.7c94d893.js"><link rel="prefetch" href="/assets/js/368.eabc3b91.js"><link rel="prefetch" href="/assets/js/369.fd1df925.js"><link rel="prefetch" href="/assets/js/37.11451496.js"><link rel="prefetch" href="/assets/js/370.425a913b.js"><link rel="prefetch" href="/assets/js/371.3f270c04.js"><link rel="prefetch" href="/assets/js/372.ad47799b.js"><link rel="prefetch" href="/assets/js/373.3f422c31.js"><link rel="prefetch" href="/assets/js/374.0cf0a589.js"><link rel="prefetch" href="/assets/js/375.1c1b93be.js"><link rel="prefetch" href="/assets/js/376.31174f57.js"><link rel="prefetch" href="/assets/js/377.13e0af89.js"><link rel="prefetch" href="/assets/js/378.8737a4a8.js"><link rel="prefetch" href="/assets/js/379.2a0a2812.js"><link rel="prefetch" href="/assets/js/38.173841cb.js"><link rel="prefetch" href="/assets/js/380.aab2ba84.js"><link rel="prefetch" href="/assets/js/381.5615c04c.js"><link rel="prefetch" href="/assets/js/382.d90ab831.js"><link rel="prefetch" href="/assets/js/383.9a4bbb6d.js"><link rel="prefetch" href="/assets/js/384.ea3aba84.js"><link rel="prefetch" href="/assets/js/385.75f0710a.js"><link rel="prefetch" href="/assets/js/386.ca2718e9.js"><link rel="prefetch" href="/assets/js/387.354d21ef.js"><link rel="prefetch" href="/assets/js/388.d9045b2a.js"><link rel="prefetch" href="/assets/js/389.25413a63.js"><link rel="prefetch" href="/assets/js/39.b2127679.js"><link rel="prefetch" href="/assets/js/390.ed551fe3.js"><link rel="prefetch" href="/assets/js/391.a067cc14.js"><link rel="prefetch" href="/assets/js/392.5ab90332.js"><link rel="prefetch" href="/assets/js/393.4f3c33b3.js"><link rel="prefetch" href="/assets/js/394.03ca395f.js"><link rel="prefetch" href="/assets/js/395.a3635303.js"><link rel="prefetch" href="/assets/js/396.b0a48716.js"><link rel="prefetch" href="/assets/js/397.645e7967.js"><link rel="prefetch" href="/assets/js/398.2e68f658.js"><link rel="prefetch" href="/assets/js/399.12074550.js"><link rel="prefetch" href="/assets/js/4.57f396da.js"><link rel="prefetch" href="/assets/js/40.6289e1b3.js"><link rel="prefetch" href="/assets/js/400.fda61f98.js"><link rel="prefetch" href="/assets/js/401.dbab358c.js"><link rel="prefetch" href="/assets/js/402.ce374870.js"><link rel="prefetch" href="/assets/js/404.1eca5fa9.js"><link rel="prefetch" href="/assets/js/405.007474ef.js"><link rel="prefetch" href="/assets/js/406.9ef3bf8f.js"><link rel="prefetch" href="/assets/js/407.49d0a838.js"><link rel="prefetch" href="/assets/js/408.62ce874a.js"><link rel="prefetch" href="/assets/js/409.acb83f82.js"><link rel="prefetch" href="/assets/js/41.dc6d13ae.js"><link rel="prefetch" href="/assets/js/410.ded2fe8b.js"><link rel="prefetch" href="/assets/js/411.101dd5a9.js"><link rel="prefetch" href="/assets/js/412.3ebc70ac.js"><link rel="prefetch" href="/assets/js/413.e8ab2c41.js"><link rel="prefetch" href="/assets/js/414.1ec2e69b.js"><link rel="prefetch" href="/assets/js/42.4b8c4d77.js"><link rel="prefetch" href="/assets/js/43.8074f136.js"><link rel="prefetch" href="/assets/js/44.0275be6d.js"><link rel="prefetch" href="/assets/js/45.09292bde.js"><link rel="prefetch" href="/assets/js/46.b0087dec.js"><link rel="prefetch" href="/assets/js/47.11ebc4d0.js"><link rel="prefetch" href="/assets/js/48.930ca5b3.js"><link rel="prefetch" href="/assets/js/49.bfff3941.js"><link rel="prefetch" href="/assets/js/5.77a423bf.js"><link rel="prefetch" href="/assets/js/50.5984f99a.js"><link rel="prefetch" href="/assets/js/51.5d81104f.js"><link rel="prefetch" href="/assets/js/52.8a0beb32.js"><link rel="prefetch" href="/assets/js/53.938a2cbe.js"><link rel="prefetch" href="/assets/js/54.72bd128c.js"><link rel="prefetch" href="/assets/js/55.1bc73709.js"><link rel="prefetch" href="/assets/js/56.b9c5dcc8.js"><link rel="prefetch" href="/assets/js/57.55cec04f.js"><link rel="prefetch" href="/assets/js/58.56fe85fa.js"><link rel="prefetch" href="/assets/js/59.afa1b570.js"><link rel="prefetch" href="/assets/js/6.6f760c85.js"><link rel="prefetch" href="/assets/js/60.9ce60716.js"><link rel="prefetch" href="/assets/js/61.e70528d5.js"><link rel="prefetch" href="/assets/js/62.61236470.js"><link rel="prefetch" href="/assets/js/63.40581113.js"><link rel="prefetch" href="/assets/js/64.e2504c75.js"><link rel="prefetch" href="/assets/js/65.64bb7a47.js"><link rel="prefetch" href="/assets/js/66.3478c00a.js"><link rel="prefetch" href="/assets/js/67.9a47a41e.js"><link rel="prefetch" href="/assets/js/68.3dd8a6c5.js"><link rel="prefetch" href="/assets/js/69.9bdb8207.js"><link rel="prefetch" href="/assets/js/7.82dedd58.js"><link rel="prefetch" href="/assets/js/70.3ffe5f25.js"><link rel="prefetch" href="/assets/js/71.3bf8df7d.js"><link rel="prefetch" href="/assets/js/72.10b3c317.js"><link rel="prefetch" href="/assets/js/73.7028d713.js"><link rel="prefetch" href="/assets/js/74.c2b3f69c.js"><link rel="prefetch" href="/assets/js/75.31241789.js"><link rel="prefetch" href="/assets/js/76.9dbde09c.js"><link rel="prefetch" href="/assets/js/77.2e13b50c.js"><link rel="prefetch" href="/assets/js/78.42d1386b.js"><link rel="prefetch" href="/assets/js/79.235c6f12.js"><link rel="prefetch" href="/assets/js/8.b0e435f5.js"><link rel="prefetch" href="/assets/js/80.7aaf7b85.js"><link rel="prefetch" href="/assets/js/81.cc38248a.js"><link rel="prefetch" href="/assets/js/82.a209ca7b.js"><link rel="prefetch" href="/assets/js/83.3fbc5318.js"><link rel="prefetch" href="/assets/js/84.85465c0d.js"><link rel="prefetch" href="/assets/js/85.144fa5bc.js"><link rel="prefetch" href="/assets/js/86.0c263e44.js"><link rel="prefetch" href="/assets/js/87.a33b9020.js"><link rel="prefetch" href="/assets/js/88.adfbb198.js"><link rel="prefetch" href="/assets/js/89.2c3492d3.js"><link rel="prefetch" href="/assets/js/9.b918cea6.js"><link rel="prefetch" href="/assets/js/90.6743afe4.js"><link rel="prefetch" href="/assets/js/91.8bbf02d4.js"><link rel="prefetch" href="/assets/js/92.b1a26755.js"><link rel="prefetch" href="/assets/js/93.e6a56250.js"><link rel="prefetch" href="/assets/js/94.1e4b20df.js"><link rel="prefetch" href="/assets/js/95.27eb582f.js"><link rel="prefetch" href="/assets/js/96.a1afc1be.js"><link rel="prefetch" href="/assets/js/97.0193aee5.js"><link rel="prefetch" href="/assets/js/98.67d6298c.js"><link rel="prefetch" href="/assets/js/99.28bb5346.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ceb4cb47.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/icode-logo.png" alt="icode" class="logo"> <span class="site-name can-hide">icode</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Android" class="dropdown-title"><a href="/android/" class="link-title">Android</a> <span class="title" style="display:none;">Android</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Androidå­¦ä¹ </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/51b303/" class="nav-link">ğŸ“åŸºç¡€å†…å®¹</a></li><li class="dropdown-subitem"><a href="/pages/3e134f/" class="nav-link">ğŸ“ºAndroidCore</a></li><li class="dropdown-subitem"><a href="/pages/e4a74c/" class="nav-link">ğŸ¨Android-UI</a></li><li class="dropdown-subitem"><a href="/pages/49df9e/" class="nav-link">ğŸ–ï¸Components</a></li><li class="dropdown-subitem"><a href="/pages/95e963/" class="nav-link">ğŸ“ŠFragment</a></li><li class="dropdown-subitem"><a href="/pages/7ba642/" class="nav-link">ğŸ”—ç½‘ç»œæ“ä½œ</a></li><li class="dropdown-subitem"><a href="/pages/83b5b7/" class="nav-link">ğŸ”å¼‚æ­¥æœºåˆ¶</a></li><li class="dropdown-subitem"><a href="/pages/eecb9c/" class="nav-link">ğŸ“¦æ•°æ®å­˜å‚¨</a></li><li class="dropdown-subitem"><a href="/pages/eecb9c/" class="nav-link">ğŸ—ƒï¸Gradle</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/frame/" class="nav-link">ã€æ¡†æ¶ã€ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/kotlin/" class="nav-link">ã€Kotlinã€ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">ã€ŠVueã€‹ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">ã€ŠGitã€‹å­¦ä¹ ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/bug/" class="nav-link">ã€Bugè¸©å‘è®°å½•ã€</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Component" class="dropdown-title"><a href="/component/" class="link-title">Component</a> <span class="title" style="display:none;">Component</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/04bab7/" class="nav-link">ListView</a></li><li class="dropdown-item"><!----> <a href="/pages/e51974/" class="nav-link">RecyclerView</a></li><li class="dropdown-item"><!----> <a href="/pages/2074bf/" class="nav-link">ViewPager</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Javaåç«¯" class="dropdown-title"><a href="/java/" class="link-title">Javaåç«¯</a> <span class="title" style="display:none;">Javaåç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Javaç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/b003f8/" class="nav-link">ğŸŸ JavaSE</a></li><li class="dropdown-subitem"><a href="/pages/d65d4f/" class="nav-link">ğŸŸ¢JavaWeb</a></li><li class="dropdown-subitem"><a href="/pages/f7d1fe/" class="nav-link">ğŸ”´JavaEE</a></li><li class="dropdown-subitem"><a href="/pages/78e80a/" class="nav-link">âšªJavaTopic</a></li><li class="dropdown-subitem"><a href="/pages/1ce44e/" class="nav-link">ğŸ³è®¾è®¡æ¨¡å¼</a></li></ul></li><li class="dropdown-item"><h4>è®¡ç®—æœºåŸºç¡€</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/csnet/" class="nav-link">ğŸ“Œè®¡ç®—æœºç½‘ç»œ</a></li><li class="dropdown-subitem"><a href="/note/datastruct/" class="nav-link">ğŸ”æ•°æ®ç»“æ„</a></li><li class="dropdown-subitem"><a href="/note/database/" class="nav-link">ğŸ“¦æ•°æ®åº“</a></li><li class="dropdown-subitem"><a href="/note/os/" class="nav-link">ğŸ’»OS</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŠ€æœ¯" class="dropdown-title"><a href="/technology/" class="link-title">æŠ€æœ¯</a> <span class="title" style="display:none;">æŠ€æœ¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">æŠ€æœ¯æ–‡æ¡£</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHubæŠ€å·§</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">åšå®¢æ­å»º</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ›´å¤š" class="dropdown-title"><a href="/more/" class="link-title">æ›´å¤š</a> <span class="title" style="display:none;">æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">å­¦ä¹ </a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">é¢è¯•</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">å¿ƒæƒ…æ‚è´§</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">å®ç”¨æŠ€å·§</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">å‹æƒ…é“¾æ¥</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="About" class="dropdown-title"><a href="/about/" class="link-title">About</a> <span class="title" style="display:none;">About</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å…³äº</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1cbe0d/" class="nav-link">ğŸ“«å…³äºæˆ‘</a></li></ul></li><li class="dropdown-item"><h4>æ”¶è—</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">ç½‘ç«™</a></li><li class="dropdown-subitem"><a href="/pages/eee83a9211a70f9d/" class="nav-link">èµ„æº</a></li><li class="dropdown-subitem"><a href="/pages/12df8ace52d493f6/" class="nav-link">Vueèµ„æº</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/iqqcode/icode" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>iqqcode</h3> <span>ä¿æŒå¯¹æŠ€æœ¯çš„æ¢ç´¢å®è·µä¸çƒ­çˆ±</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Android" class="dropdown-title"><a href="/android/" class="link-title">Android</a> <span class="title" style="display:none;">Android</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Androidå­¦ä¹ </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/51b303/" class="nav-link">ğŸ“åŸºç¡€å†…å®¹</a></li><li class="dropdown-subitem"><a href="/pages/3e134f/" class="nav-link">ğŸ“ºAndroidCore</a></li><li class="dropdown-subitem"><a href="/pages/e4a74c/" class="nav-link">ğŸ¨Android-UI</a></li><li class="dropdown-subitem"><a href="/pages/49df9e/" class="nav-link">ğŸ–ï¸Components</a></li><li class="dropdown-subitem"><a href="/pages/95e963/" class="nav-link">ğŸ“ŠFragment</a></li><li class="dropdown-subitem"><a href="/pages/7ba642/" class="nav-link">ğŸ”—ç½‘ç»œæ“ä½œ</a></li><li class="dropdown-subitem"><a href="/pages/83b5b7/" class="nav-link">ğŸ”å¼‚æ­¥æœºåˆ¶</a></li><li class="dropdown-subitem"><a href="/pages/eecb9c/" class="nav-link">ğŸ“¦æ•°æ®å­˜å‚¨</a></li><li class="dropdown-subitem"><a href="/pages/eecb9c/" class="nav-link">ğŸ—ƒï¸Gradle</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/frame/" class="nav-link">ã€æ¡†æ¶ã€ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/kotlin/" class="nav-link">ã€Kotlinã€ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">ã€ŠVueã€‹ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">ã€ŠGitã€‹å­¦ä¹ ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/bug/" class="nav-link">ã€Bugè¸©å‘è®°å½•ã€</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Component" class="dropdown-title"><a href="/component/" class="link-title">Component</a> <span class="title" style="display:none;">Component</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/04bab7/" class="nav-link">ListView</a></li><li class="dropdown-item"><!----> <a href="/pages/e51974/" class="nav-link">RecyclerView</a></li><li class="dropdown-item"><!----> <a href="/pages/2074bf/" class="nav-link">ViewPager</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Javaåç«¯" class="dropdown-title"><a href="/java/" class="link-title">Javaåç«¯</a> <span class="title" style="display:none;">Javaåç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Javaç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/b003f8/" class="nav-link">ğŸŸ JavaSE</a></li><li class="dropdown-subitem"><a href="/pages/d65d4f/" class="nav-link">ğŸŸ¢JavaWeb</a></li><li class="dropdown-subitem"><a href="/pages/f7d1fe/" class="nav-link">ğŸ”´JavaEE</a></li><li class="dropdown-subitem"><a href="/pages/78e80a/" class="nav-link">âšªJavaTopic</a></li><li class="dropdown-subitem"><a href="/pages/1ce44e/" class="nav-link">ğŸ³è®¾è®¡æ¨¡å¼</a></li></ul></li><li class="dropdown-item"><h4>è®¡ç®—æœºåŸºç¡€</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/csnet/" class="nav-link">ğŸ“Œè®¡ç®—æœºç½‘ç»œ</a></li><li class="dropdown-subitem"><a href="/note/datastruct/" class="nav-link">ğŸ”æ•°æ®ç»“æ„</a></li><li class="dropdown-subitem"><a href="/note/database/" class="nav-link">ğŸ“¦æ•°æ®åº“</a></li><li class="dropdown-subitem"><a href="/note/os/" class="nav-link">ğŸ’»OS</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŠ€æœ¯" class="dropdown-title"><a href="/technology/" class="link-title">æŠ€æœ¯</a> <span class="title" style="display:none;">æŠ€æœ¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">æŠ€æœ¯æ–‡æ¡£</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHubæŠ€å·§</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">åšå®¢æ­å»º</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ›´å¤š" class="dropdown-title"><a href="/more/" class="link-title">æ›´å¤š</a> <span class="title" style="display:none;">æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">å­¦ä¹ </a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">é¢è¯•</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">å¿ƒæƒ…æ‚è´§</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">å®ç”¨æŠ€å·§</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">å‹æƒ…é“¾æ¥</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="About" class="dropdown-title"><a href="/about/" class="link-title">About</a> <span class="title" style="display:none;">About</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å…³äº</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/1cbe0d/" class="nav-link">ğŸ“«å…³äºæˆ‘</a></li></ul></li><li class="dropdown-item"><h4>æ”¶è—</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">ç½‘ç«™</a></li><li class="dropdown-subitem"><a href="/pages/eee83a9211a70f9d/" class="nav-link">èµ„æº</a></li><li class="dropdown-subitem"><a href="/pages/12df8ace52d493f6/" class="nav-link">Vueèµ„æº</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/iqqcode/icode" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>åŸºç¡€å†…å®¹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>TCP-IP</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/463f56/" class="sidebar-link">ã€OSI-TCPç½‘ç»œæ¨¡å‹ã€‘</a></li><li><a href="/pages/72c63f/" class="sidebar-link">HTTP-è¶…æ–‡æœ¬ä¼ è¾“åè®®</a></li><li><a href="/pages/e15b33/" class="sidebar-link">HTTPS</a></li><li><a href="/pages/5a599c/" aria-current="page" class="active sidebar-link">å…¨åŒå·¥é€šè®¯çš„WebSocketåè®®</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/5a599c/#_1-httpè½®è¯¢" class="sidebar-link">1. HTTPè½®è¯¢</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_1-1-çŸ­è¿æ¥" class="sidebar-link">1.1 çŸ­è¿æ¥</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_1-2-é•¿è¿æ¥" class="sidebar-link">1.2 é•¿è¿æ¥</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_1-3-socket" class="sidebar-link">1.3 Socket</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/5a599c/#_2-websocket" class="sidebar-link">2. WebSocket</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_2-1-websocketçš„æ¼”è¿›" class="sidebar-link">2.1 WebSocketçš„æ¼”è¿›</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_2-2-ğŸš€websocket" class="sidebar-link">2.2 ğŸš€Websocket</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_2-3-ä¸ºä»€ä¹ˆè¦é€‰æ‹©websocket" class="sidebar-link">2.3 ä¸ºä»€ä¹ˆè¦é€‰æ‹©WebSocket</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_2-4-åŸºäºtcp" class="sidebar-link">2.4 åŸºäºTCP</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_2-5-æˆç†Ÿçš„websocketæœåŠ¡å™¨ç«¯å®ç°" class="sidebar-link">2.5 æˆç†Ÿçš„WebSocketæœåŠ¡å™¨ç«¯å®ç°</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/5a599c/#_3-websocketåè®®é€šä¿¡åŸç†" class="sidebar-link">3. WebSocketåè®®é€šä¿¡åŸç†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_3-1-åè®®å‡çº§" class="sidebar-link">3.1 åè®®å‡çº§</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_3-2-å»ºç«‹websocketè¿æ¥" class="sidebar-link">3.2 å»ºç«‹WebSocketè¿æ¥</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_3-3-æ¡æ‰‹" class="sidebar-link">3.3 æ¡æ‰‹</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_3-4-è¯·æ±‚æ•°æ®" class="sidebar-link">3.4 è¯·æ±‚æ•°æ®</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/5a599c/#_4-å®¢æˆ·ç«¯é€šä¿¡" class="sidebar-link">4. å®¢æˆ·ç«¯é€šä¿¡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_4-1-websocketå¯¹è±¡" class="sidebar-link">4.1 WebSocketå¯¹è±¡</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_4-2-websocketäº‹ä»¶" class="sidebar-link">4.2 WebSocketäº‹ä»¶</a></li><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#_4-3-websocketæ–¹æ³•" class="sidebar-link">4.3 WebSocketæ–¹æ³•</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/5a599c/#_5-æœåŠ¡ç«¯é€šä¿¡" class="sidebar-link">5. æœåŠ¡ç«¯é€šä¿¡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/5a599c/#å¿ƒè·³ä¿æ´»" class="sidebar-link">å¿ƒè·³ä¿æ´»</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/5a599c/#_6-websocketç¤ºä¾‹" class="sidebar-link">6. WebSocketç¤ºä¾‹</a></li><li class="sidebar-sub-header level2"><a href="/pages/5a599c/#_7-websocketä»‹ç»å’Œsocketçš„åŒºåˆ«" class="sidebar-link">7. WebSocketä»‹ç»å’ŒSocketçš„åŒºåˆ«</a></li><li class="sidebar-sub-header level2"><a href="/pages/5a599c/#_8-websocketçš„ä½¿ç”¨åœºæ™¯" class="sidebar-link">8. WebSocketçš„ä½¿ç”¨åœºæ™¯</a></li></ul></li><li><a href="/pages/544f29/" class="sidebar-link">DNS</a></li><li><a href="/pages/a90f39/" class="sidebar-link">ä¼ è¾“å±‚</a></li><li><a href="/pages/e44117/" class="sidebar-link">ç½‘ç»œå±‚</a></li><li><a href="/pages/883846/" class="sidebar-link">UDPåè®®</a></li><li><a href="/pages/0066d2/" class="sidebar-link">TCPæ¡æ‰‹æŒ¥æ‰‹</a></li><li><a href="/pages/b1d16a/" class="sidebar-link">TCPå¯é ä¼ è¾“</a></li><li><a href="/pages/52c40c/" class="sidebar-link">è¾“å…¥URLåˆ°è·³è½¬</a></li><li><a href="/pages/1a7e3c/" class="sidebar-link">Pingå‘½ä»¤</a></li></ul></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- æ­£æ–¹å½¢ -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/note/csnet/#è®¡ç®—æœºç½‘ç»œ" data-v-06225672>è®¡ç®—æœºç½‘ç»œ</a></li><li data-v-06225672><a href="/note/csnet/#TCP-IP" data-v-06225672>TCP-IP</a></li></ul> <div class="info" data-v-06225672><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/IQQcode" target="_blank" title="ä½œè€…" class="beLink" data-v-06225672>iqqcode</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2021-06-17</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">å…¨åŒå·¥é€šè®¯çš„WebSocketåè®®<!----></h1> <div class="page-slot page-slot-top"><!-- å›ºå®š100% * 90pxå¯æ˜¾ç¤ºï¼Œmax-height:90pxæœªè§æ˜¾ç¤º-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><blockquote><p>ğŸ“š å®˜æ–¹æ–‡æ¡£ <a href="https://tools.ietf.org/html/draft-abarth-thewebsocketprotocol-00" target="_blank" rel="noopener noreferrer"><strong>The WebSocket protocol</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ğŸ§Š <a href="http://websocket.org/aboutwebsocket.html" target="_blank" rel="noopener noreferrer"><strong>WebSocketå®˜ç½‘</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ğŸ”—å®‰åˆ©æ–‡ç«  <a href="https://halfrost.com/websocket/" target="_blank" rel="noopener noreferrer"><strong>å…¨åŒå·¥é€šä¿¡çš„ WebSocket</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p><strong>ã€å®æ—¶ Web åº”ç”¨çš„çª˜å¢ƒã€‘</strong></p> <p>Web åº”ç”¨çš„ä¿¡æ¯äº¤äº’è¿‡ç¨‹é€šå¸¸æ˜¯å®¢æˆ·ç«¯é€šè¿‡æµè§ˆå™¨å‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶å’Œå®¡æ ¸å®Œè¯·æ±‚åè¿›è¡Œå¤„ç†å¹¶è¿”å›ç»“æœç»™å®¢æˆ·ç«¯ï¼Œç„¶åå®¢æˆ·ç«¯æµè§ˆå™¨å°†ä¿¡æ¯å‘ˆç°å‡ºæ¥ï¼Œè¿™ç§æœºåˆ¶å¯¹äºä¿¡æ¯å˜åŒ–ä¸æ˜¯ç‰¹åˆ«é¢‘ç¹çš„åº”ç”¨å°šèƒ½ç›¸å®‰æ— äº‹ï¼Œä½†æ˜¯å¯¹äºé‚£äº›å®æ—¶è¦æ±‚æ¯”è¾ƒé«˜çš„åº”ç”¨æ¥è¯´ï¼Œæ¯”å¦‚è¯´åœ¨çº¿æ¸¸æˆã€åœ¨çº¿è¯åˆ¸ã€è®¾å¤‡ç›‘æ§ã€æ–°é—»åœ¨çº¿æ’­æŠ¥ã€RSS è®¢é˜…æ¨é€ç­‰ç­‰ï¼Œå½“å®¢æˆ·ç«¯æµè§ˆå™¨å‡†å¤‡å‘ˆç°è¿™äº›ä¿¡æ¯çš„æ—¶å€™ï¼Œè¿™äº›ä¿¡æ¯åœ¨æœåŠ¡å™¨ç«¯å¯èƒ½å·²ç»è¿‡æ—¶äº†ã€‚æ‰€ä»¥ä¿æŒå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„ä¿¡æ¯åŒæ­¥æ˜¯å®æ—¶ Web åº”ç”¨çš„å…³é”®è¦ç´ ï¼Œå¯¹ Web å¼€å‘äººå‘˜æ¥è¯´ä¹Ÿæ˜¯ä¸€ä¸ªéš¾é¢˜ã€‚åœ¨ WebSocket è§„èŒƒå‡ºæ¥ä¹‹å‰ï¼Œå¼€å‘äººå‘˜æƒ³å®ç°è¿™äº›å®æ—¶çš„ Web åº”ç”¨ï¼Œä¸å¾—ä¸é‡‡ç”¨ä¸€äº›æŠ˜è¡·çš„æ–¹æ¡ˆï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„å°±æ˜¯è½®è¯¢ (Polling) å’Œ Comet æŠ€æœ¯ï¼Œè€Œ Comet æŠ€æœ¯å®é™…ä¸Šæ˜¯è½®è¯¢æŠ€æœ¯çš„æ”¹è¿›ï¼Œåˆå¯ç»†åˆ†ä¸ºä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§æ˜¯é•¿è½®è¯¢æœºåˆ¶ï¼Œä¸€ç§ç§°ä¸ºæµæŠ€æœ¯ã€‚</p> <br> <h2 id="_1-httpè½®è¯¢"><a href="#_1-httpè½®è¯¢" class="header-anchor">#</a> 1. HTTPè½®è¯¢</h2> <p><strong>é¦–å…ˆHTTPä¸­ï¼Œæ²¡æœ‰é•¿è¿æ¥è¿™æ ·çš„ç±»å‹</strong>ã€‚<strong>HTTPè¦å®ç°é•¿è¿æ¥ï¼Œæ˜¯å»ºç«‹åœ¨TCPåè®®çš„åŸºç¡€ä¸Šçš„ã€‚</strong></p> <p>ã€<strong>TCPçš„keep aliveå’ŒHTTPçš„Keep-alive</strong>ã€‘</p> <ul><li>TCPçš„keep aliveæ˜¯æ£€æŸ¥å½“å‰TCPè¿æ¥<strong>æ˜¯å¦æ´»ç€</strong></li> <li>HTTPçš„Keep-aliveæ˜¯è¦è®©ä¸€ä¸ªTCPè¿æ¥<strong>æ´»ä¹…ç‚¹</strong></li></ul> <h3 id="_1-1-çŸ­è¿æ¥"><a href="#_1-1-çŸ­è¿æ¥" class="header-anchor">#</a> 1.1 çŸ­è¿æ¥</h3> <p>Web åº”ç”¨é€šè¿‡é€šè¿‡é¢‘ç¹çš„å¼‚æ­¥ JavaScript å’Œ XML (AJAX) è¯·æ±‚æ¥å®ç°è½®å¾ª</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192247.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿›è¡Œä¸€æ¬¡HTTPè¯·æ±‚/å“åº”ä¹‹åï¼Œå°±å…³é—­è¿æ¥ã€‚ä¸‹ä¸€æ¬¡çš„HTTPè¯·æ±‚/å“åº”æ“ä½œéœ€è¦é‡æ–°å»ºç«‹ã€‚</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code># åœ¨é¦–éƒ¨å­—æ®µä¸­è®¾ç½®çŸ­è¿æ¥
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span><span class="token header-value">close</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>åœ¨ä¸€æ¬¡è¯·æ±‚/å“åº”ä¹‹åï¼Œå°±ä¼šå…³é—­è¿æ¥ã€‚è¿™ç§æ–¹å¼ä¸‹ï¼Œæ˜¯ä¸é€‚åˆè·å–å®æ—¶ä¿¡æ¯çš„ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼šä¸€ç›´è¿›è¡Œè¿æ¥ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å°±è¯¢é—®ä¸€æ¬¡ã€‚å®¢æˆ·ç«¯ä¼šè½®è¯¢ï¼Œæœ‰æ²¡æœ‰æ–°æ¶ˆæ¯ã€‚è¿™ç§æ–¹å¼è¿æ¥æ•°ä¼šå¾ˆå¤šï¼Œä¸€ä¸ªæ¥å—ï¼Œä¸€ä¸ªå‘é€ã€‚è€Œä¸”æ¯æ¬¡å‘é€è¯·æ±‚éƒ½ä¼šæœ‰ HTTP çš„ Headerï¼Œä¼šå¾ˆè€—æµé‡ï¼Œä¹Ÿä¼šæ¶ˆè€— CPU çš„åˆ©ç”¨ç‡ã€‚</p> <ul><li>ä¼˜ç‚¹ï¼šçŸ­è¿æ¥ï¼ŒæœåŠ¡å™¨å¤„ç†ç®€å•ï¼Œæ”¯æŒè·¨åŸŸã€æµè§ˆå™¨å…¼å®¹æ€§è¾ƒå¥½ã€‚</li> <li>ç¼ºç‚¹ï¼šæœ‰ä¸€å®šå»¶è¿Ÿã€æœåŠ¡å™¨å‹åŠ›è¾ƒå¤§ï¼Œæµªè´¹å¸¦å®½æµé‡ã€å¤§éƒ¨åˆ†æ˜¯æ— æ•ˆè¯·æ±‚ã€‚</li></ul> <br> <h3 id="_1-2-é•¿è¿æ¥"><a href="#_1-2-é•¿è¿æ¥" class="header-anchor">#</a> 1.2 é•¿è¿æ¥</h3> <p><strong>HTTP1.1</strong>æ”¯æŒäº†å¹¶ä¸”é»˜è®¤äº†<strong>é•¿è¿æ¥</strong>ã€‚å› ä¸ºæœ‰äº†é•¿è¿æ¥ï¼Œæ‰€ä»¥ä¸ç”¨å®šæ—¶è½®è¯¢æ¥æˆ¿å­è¿æ¥å…³é—­ã€‚é•¿è½®è¯¢æ˜¯å¯¹å®šæ—¶è½®è¯¢çš„æ”¹è¿›å’Œæé«˜ï¼Œç›®åœ°æ˜¯ä¸ºäº†é™ä½æ— æ•ˆçš„ç½‘ç»œä¼ è¾“ã€‚å½“æœåŠ¡å™¨ç«¯æ²¡æœ‰æ•°æ®æ›´æ–°çš„æ—¶å€™ï¼Œè¿æ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´å‘¨æœŸç›´åˆ°æ•°æ®æˆ–çŠ¶æ€æ”¹å˜æˆ–è€…æ—¶é—´è¿‡æœŸï¼Œé€šè¿‡è¿™ç§æœºåˆ¶æ¥å‡å°‘æ— æ•ˆçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é—´çš„äº¤äº’ã€‚</p> <p>å®¢æˆ·ç«¯æ‰“å¼€ä¸€ä¸ªåˆ°æœåŠ¡å™¨ç«¯çš„ AJAX è¯·æ±‚ï¼Œç„¶åç­‰å¾…å“åº”ï¼ŒæœåŠ¡å™¨ç«¯éœ€è¦ä¸€äº›ç‰¹å®šçš„åŠŸèƒ½æ¥å…è®¸è¯·æ±‚è¢«æŒ‚èµ·ï¼Œåªè¦ä¸€æœ‰äº‹ä»¶å‘ç”Ÿï¼ŒæœåŠ¡å™¨ç«¯å°±ä¼šåœ¨æŒ‚èµ·çš„è¯·æ±‚ä¸­é€å›å“åº”å¹¶å…³é—­è¯¥è¯·æ±‚ã€‚å®¢æˆ·ç«¯åœ¨å¤„ç†å®ŒæœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯åï¼Œå†æ¬¡å‘å‡ºè¯·æ±‚ï¼Œé‡æ–°å»ºç«‹è¿æ¥ï¼Œå¦‚æ­¤å¾ªç¯ã€‚</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192253.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹ä¸€æ¬¡è¿æ¥ä¹‹åï¼Œä¼šå¤ç”¨è¿™æ¡é“¾æ¥ï¼Œå¯ä»¥åœ¨è¿™æ¡è¿æ¥ä¸Šè¿›è¡Œå¤šæ¬¡<code>è¯·æ±‚/å“åº”</code>æ“ä½œã€‚å½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“HTTPæ•°æ®çš„ TCPè¿æ¥ä¸ä¼šå…³é—­ï¼Œå¦‚æœå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥ã€‚</p> <p>è¿™ç§æ–¹å¼ä¹Ÿæœ‰ä¸€å®šçš„å¼Šç«¯ï¼Œå®æ—¶æ€§ä¸é«˜ã€‚å¦‚æœæ˜¯é«˜å®æ—¶çš„ç³»ç»Ÿï¼Œè‚¯å®šä¸ä¼šé‡‡ç”¨è¿™ç§åŠæ³•ã€‚å› ä¸ºä¸€ä¸ª GET è¯·æ±‚æ¥å›éœ€è¦ 2ä¸ª RTTï¼Œå¾ˆå¯èƒ½åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œæ•°æ®å˜åŒ–å¾ˆå¤§ï¼Œå®¢æˆ·ç«¯æ‹¿åˆ°çš„æ•°æ®å·²ç»å»¶åå¾ˆå¤šäº†ã€‚</p> <p>å¦å¤–ï¼Œç½‘ç»œå¸¦å®½ä½åˆ©ç”¨ç‡çš„é—®é¢˜ä¹Ÿæ²¡æœ‰ä»æ ¹æºä¸Šè§£å†³ã€‚æ¯ä¸ª Request éƒ½ä¼šå¸¦ç›¸åŒçš„ Headerã€‚</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code>// åªè®¾ç½®Connection:keep-aliveï¼Œè¡¨æ˜è¿æ¥æ°¸ä¹…æœ‰æ•ˆ
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">keep-alive</span></span>

<span class="token header"><span class="token header-name keyword">Keep-Alive</span><span class="token punctuation">:</span> <span class="token header-value">timeout = 60</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>è¡¨æ˜è¿æ¥å»ºç«‹ä¹‹åï¼Œç©ºé—²æ—¶é—´è¶…è¿‡60ç§’ï¼Œè¿æ¥å¤±æ•ˆ</li> <li>å¦‚æœåœ¨ç©ºé—²ç¬¬58ç§’ä½¿ç”¨æ­¤è¿æ¥ï¼Œåˆ™ä»ç„¶æœ‰æ•ˆï¼Œ</li> <li>å¹¶ä¸”ä½¿ç”¨å®Œä¹‹åï¼Œé‡æ–°è®¡æ•°ç©ºé—²æ—¶é—´ï¼Œç©ºé—²60ç§’æ— å†ä½¿ç”¨ï¼Œè¿æ¥å¤±æ•ˆ</li></ul> <p>æŒä¹…è¿æ¥å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿå¯ä»¥ä¸è®¾ç½®ã€‚</p> <ul><li>ä¼˜ç‚¹ï¼šå‡å°‘è½®è¯¢æ¬¡æ•°ï¼Œä½å»¶è¿Ÿï¼Œæµè§ˆå™¨å…¼å®¹æ€§è¾ƒå¥½ã€‚</li> <li>ç¼ºç‚¹ï¼šæœåŠ¡å™¨éœ€è¦ä¿æŒå¤§é‡è¿æ¥ã€‚</li></ul> <br> <h3 id="_1-3-socket"><a href="#_1-3-socket" class="header-anchor">#</a> 1.3 Socket</h3> <p>åŸºäºæµçš„æ–¹å¼ï¼Œåœ¨æœåŠ¡å™¨å¾€å®¢æˆ·ç«¯æ¨é€ï¼Œè¿™ä¸ªæ–¹å‘çš„æµ<strong>å®æ—¶æ€§</strong>æ¯”è¾ƒå¥½ã€‚<strong>ä½†æ˜¯ä¾æ—§æ˜¯å•å‘çš„ï¼Œå®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ä¾ç„¶è¿˜éœ€è¦ä¸€æ¬¡ HTTP è¯·æ±‚</strong></p> <p><strong>Socketç½‘ç»œç¼–ç¨‹</strong></p> <ul><li>Socketåœ¨åº”ç”¨ä¹‹é—´å»ºç«‹ä¿¡é“è¿æ¥ï¼Œé€šè¿‡<code>IO</code>æµæ¥ä¼ è¾“æ•°æ®</li> <li>åŸºäº<strong>JFrame</strong>ï¼Œå°è£…æ€§ã€æ˜“ç”¨æ€§ä½</li></ul> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192259.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>åŸºäºTCPåè®®</p> <p>ã€å®¢æˆ·ç«¯ã€‘ï¼š</p> <ul><li>åˆ›å»ºå®¢æˆ·ç«¯å¥—æ¥å­—ï¼ˆå°è¯•è¿æ¥ï¼‰</li> <li>ç­‰å¾…è¿æ¥</li> <li>è·å–è¾“å…¥æµã€è¾“å‡ºæµ</li> <li>å…³é—­è¿æ¥</li></ul> <p>ã€æœåŠ¡ç«¯ã€‘ï¼š</p> <ul><li>åˆ›å»ºæœåŠ¡ç«¯å¥—æ¥å­—</li> <li>ç­‰å¾…è¿æ¥</li> <li>è·å–è¾“å…¥æµã€è¾“å‡ºæµ</li> <li>å…³é—­è¿æ¥</li></ul> <p>ã€æ•°æ®ä¼ è¾“ã€‘ï¼šåœ¨ä¸¤ä¸ªå¥—æ¥å­—å»ºç«‹çš„<code>socket</code>é€šé“ä¸­è¿›è¡Œä¼ è¾“æ•°æ®æµ</p> <br> <ul><li><p>çŸ­è½®è¯¢æ•ˆç‡ä½ï¼Œéå¸¸æµªè´¹èµ„æºï¼ˆç½‘ç»œå¸¦å®½å’Œè®¡ç®—èµ„æºï¼‰ã€‚æœ‰ä¸€å®šå»¶è¿Ÿã€æœåŠ¡å™¨å‹åŠ›è¾ƒå¤§ï¼Œå¹¶ä¸”å¤§éƒ¨åˆ†æ˜¯æ— æ•ˆè¯·æ±‚ã€‚</p></li> <li><p>é•¿è½®è¯¢è™½ç„¶çœå»äº†å¤§é‡æ— æ•ˆè¯·æ±‚ï¼Œå‡å°‘äº†æœåŠ¡å™¨å‹åŠ›å’Œä¸€å®šçš„ç½‘ç»œå¸¦å®½çš„å ç”¨ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦ä¿æŒå¤§é‡çš„è¿æ¥ã€‚</p></li> <li><p>æœ€ååˆ°äº†åŸºäºæµçš„æ–¹å¼ï¼Œåœ¨æœåŠ¡å™¨å¾€å®¢æˆ·ç«¯æ¨é€ï¼Œè¿™ä¸ªæ–¹å‘çš„æµå®æ—¶æ€§æ¯”è¾ƒå¥½ã€‚ä½†æ˜¯ä¾æ—§æ˜¯å•å‘çš„ï¼Œå®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ä¾ç„¶è¿˜éœ€è¦ä¸€æ¬¡ HTTP è¯·æ±‚ã€‚</p></li></ul> <hr> <br> <h2 id="_2-websocket"><a href="#_2-websocket" class="header-anchor">#</a> 2. WebSocket</h2> <h3 id="_2-1-websocketçš„æ¼”è¿›"><a href="#_2-1-websocketçš„æ¼”è¿›" class="header-anchor">#</a> 2.1 WebSocketçš„æ¼”è¿›</h3> <p>ç»¼åˆè¿™å‡ ç§æ–¹æ¡ˆï¼Œä¼šå‘ç°è¿™äº›ç›®å‰æˆ‘ä»¬æ‰€ä½¿ç”¨çš„æ‰€è°“çš„å®æ—¶æŠ€æœ¯å¹¶ä¸æ˜¯çœŸæ­£çš„å®æ—¶æŠ€æœ¯ï¼Œå®ƒä»¬åªæ˜¯åœ¨ç”¨ Ajax æ–¹å¼æ¥æ¨¡æ‹Ÿå®æ—¶çš„æ•ˆæœï¼Œåœ¨æ¯æ¬¡å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯äº¤äº’çš„æ—¶å€™éƒ½æ˜¯ä¸€æ¬¡ HTTP çš„è¯·æ±‚å’Œåº”ç­”çš„è¿‡ç¨‹ï¼Œè€Œæ¯ä¸€æ¬¡çš„ HTTP è¯·æ±‚å’Œåº”ç­”éƒ½å¸¦æœ‰å®Œæ•´çš„ HTTP å¤´ä¿¡æ¯ï¼Œè¿™å°±å¢åŠ äº†æ¯æ¬¡ä¼ è¾“çš„æ•°æ®é‡ã€‚</p> <p>è€Œä¸”è¿™äº›æ–¹æ¡ˆä¸­å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„ç¼–ç¨‹å®ç°éƒ½æ¯”è¾ƒå¤æ‚ï¼Œåœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œä¸ºäº†æ¨¡æ‹Ÿæ¯”è¾ƒçœŸå®çš„å®æ—¶æ•ˆæœï¼Œå¼€å‘äººå‘˜å¾€å¾€éœ€è¦æ„é€ ä¸¤ä¸ª HTTP è¿æ¥æ¥æ¨¡æ‹Ÿå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„åŒå‘é€šè®¯ï¼Œä¸€ä¸ªè¿æ¥ç”¨æ¥å¤„ç†å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ç«¯çš„æ•°æ®ä¼ è¾“ï¼Œä¸€ä¸ªè¿æ¥ç”¨æ¥å¤„ç†æœåŠ¡å™¨ç«¯åˆ°å®¢æˆ·ç«¯çš„æ•°æ®ä¼ è¾“ï¼Œè¿™ä¸å¯é¿å…åœ°å¢åŠ äº†ç¼–ç¨‹å®ç°çš„å¤æ‚åº¦ï¼Œä¹Ÿå¢åŠ äº†æœåŠ¡å™¨ç«¯çš„è´Ÿè½½ï¼Œåˆ¶çº¦äº†åº”ç”¨ç³»ç»Ÿçš„æ‰©å±•æ€§ã€‚</p> <br> <h3 id="_2-2-ğŸš€websocket"><a href="#_2-2-ğŸš€websocket" class="header-anchor">#</a> 2.2 ğŸš€Websocket</h3> <p>Websocketæ˜¯ä¸€ç§ç½‘ç»œé€šä¿¡åè®®ã€‚</p> <p>Websocketæ˜¯<strong>HTML5</strong>å¼€å§‹æä¾›çš„ä¸€ç§åœ¨<strong>å•ä¸ªTCPè¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯</strong>çš„åè®®ã€‚æ²¡æœ‰äº† Request å’Œ Response çš„æ¦‚å¿µï¼Œä¸¤è€…åœ°ä½å®Œå…¨å¹³ç­‰ï¼Œè¿æ¥ä¸€æ—¦å»ºç«‹ï¼Œå°±å»ºç«‹äº†çœŸæŒä¹…æ€§è¿æ¥ï¼ŒåŒæ–¹å¯ä»¥éšæ—¶å‘å¯¹æ–¹å‘é€æ•°æ®ã€‚ä½¿å¾—æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯äº¤äº’æ•°æ®æ›´åŠ ç®€å•ã€‚</p> <p>æµè§ˆå™¨å’Œå®¢æˆ·ç«¯åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œå°±å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘çš„æ•°æ®ä¼ è¾“</p> <p>HTTPåè®®æ˜¯ä¸€ç§æ— çŠ¶æ€çš„ã€æ— è¿æ¥çš„ã€å•å‘çš„åº”ç”¨å±‚åè®®ã€‚å®ƒé‡‡ç”¨äº†<strong>è¯·æ±‚ / å“åº”</strong>æ¨¡å‹ã€‚<strong>é€šä¿¡è¯·æ±‚åªèƒ½ç”±å®¢æˆ·ç«¯å‘èµ·ï¼ŒæœåŠ¡ç«¯å¯¹è¯·æ±‚åšå‡ºåº”ç­”å¤„ç†</strong></p> <p>è¿™ç§é€šä¿¡æ¨¡å‹æœ‰ä¸€ä¸ªå¼Šç«¯ï¼šHTTPåè®®æ— æ³•å®ç°æœåŠ¡å™¨<strong>ä¸»åŠ¨</strong>å‘å®¢æˆ·ç«¯å‘èµ·æ¶ˆæ¯ã€‚</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192306.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>è¿™ç§<strong>å•å‘è¯·æ±‚</strong>çš„ç‰¹ç‚¹ï¼Œæ³¨å®šäº†å¦‚æœæœåŠ¡å™¨æœ‰è¿ç»­çš„çŠ¶æ€å˜åŒ–ï¼Œå®¢æˆ¶ç«¯è¦è·çŸ¥å°±éå¸¸éº»çƒ¦ã€‚</p> <ul><li>å› ä¸ºæœåŠ¡å™¨ä¸ä¼šä¸»åŠ¨å›å¤å®¢æˆ·ç«¯è¯´æˆ‘è¿™é‡Œæœ‰æ•°æ®å˜åŒ–</li> <li>åªèƒ½æ˜¯å®¢æˆ·ç«¯é—®æœåŠ¡å™¨æœ‰æ²¡æœ‰æ•°æ®å‘ç”Ÿå˜åŒ–ï¼ŒæœåŠ¡å™¨ç»™å®¢æˆ·ç«¯åšå›åº”ã€‚</li></ul> <p>ä¸ºäº†ä¿æŒé•¿æ—¶é—´çš„é€šä¿¡è¿æ¥ï¼Œå°±éœ€è¦åŒæ­¥å®¢æˆ·ç«¯ä¸æ–­åœ°å‘é€è¯·æ±‚è¯¢é—®ï¼Œç§°ä¸º<strong>è½®è¯¢</strong>ã€‚</p> <p>å¤§å¤šæ•°Webåº”ç”¨ç¨‹åºå°†é€šè¿‡é¢‘ç¹çš„å¼‚æ­¥AJAXè¯·æ±‚å®ç°<strong>é•¿è½®è¯¢</strong>ã€‚è½®è¯¢çš„æ•ˆç‡ä½ï¼Œéå¸¸æµªè´¹èµ„æºï¼ˆå› ä¸ºå¿…é¡»ä¸åœè¿æ¥ï¼Œæˆ–è€…HTTPè¿æ¥å§‹ç»ˆæ‰“å¼€ï¼‰</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192310.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>æ‰€ä»¥ WebSocket å’Œ HTTP æœ‰ä¸€äº›äº¤é›†ï¼Œä¸¤è€…ç›¸å¼‚çš„åœ°æ–¹è¿˜æ˜¯å¾ˆå¤šã€‚ä¸¤è€…äº¤é›†çš„åœ°æ–¹åœ¨ HTTP æ¡æ‰‹é˜¶æ®µï¼Œæ¡æ‰‹æˆåŠŸåï¼Œæ•°æ®å°±ç›´æ¥ä» TCP é€šé“ä¼ è¾“ã€‚</p> <blockquote><p><strong>è½®è¯¢</strong>ï¼šåœ¨å®¢æˆ·ç«¯å®šæ—¶çš„å‘æœåŠ¡å™¨å‘é€AJAXè¯·æ±‚ï¼Œè·å–æœåŠ¡ç«¯æœ€æ–°çš„æ•°æ®</p></blockquote> <h3 id="_2-3-ä¸ºä»€ä¹ˆè¦é€‰æ‹©websocket"><a href="#_2-3-ä¸ºä»€ä¹ˆè¦é€‰æ‹©websocket" class="header-anchor">#</a> 2.3 ä¸ºä»€ä¹ˆè¦é€‰æ‹©WebSocket</h3> <p>è½®è¯¢éƒ½æ˜¯å…ˆç”±å®¢æˆ·ç«¯å‘èµ· Ajax è¯·æ±‚ï¼Œæ‰èƒ½è¿›è¡Œé€šä¿¡ï¼Œèµ°çš„æ˜¯HTTPåè®®ï¼ŒæœåŠ¡å™¨ç«¯æ— æ³•ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ã€‚</p> <p>å½“å‡ºç°ç±»ä¼¼ä½“è‚²èµ›äº‹ã€èŠå¤©å®¤ã€å®æ—¶ä½ç½®ä¹‹ç±»çš„åœºæ™¯æ—¶ï¼Œ<strong>è½®è¯¢å°±æ˜¾å¾—ååˆ†ä½æ•ˆå’Œæµªè´¹èµ„æº</strong>ã€‚</p> <p><strong>é€‰æ‹©WebSocketçš„ç†ç”±ï¼š</strong></p> <ul><li><strong>å…¨åŒå·¥é€šä¿¡ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å¯ä»¥äº’ç›¸ä¸»åŠ¨é€šä¿¡</strong>ã€‚ç”±äºåè®®æ˜¯å…¨åŒå·¥çš„ï¼Œæ‰€ä»¥æœåŠ¡å™¨å¯ä»¥éšæ—¶ä¸»åŠ¨ç»™å®¢æˆ·ç«¯å‘æ•°æ®ã€‚è€ŒHTTPåè®®ä¸­æœåŠ¡å™¨ä¸èƒ½ä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œæ˜¯å•å‘é€šä¿¡çš„</li> <li><strong>è¾ƒå°‘çš„æ§åˆ¶å¼€é”€</strong>ã€‚åè®®æ§åˆ¶çš„æ•°æ®åŒ…å¤´éƒ¨ç›¸å¯¹è¾ƒå°ï¼Œé•¿è¿æ¥å‡å°‘äº†æ¯æ¬¡è¿æ¥æ—¶æ¡æ‰‹æŒ¥æ‰‹çš„èµ„æºæ¶ˆè€—</li> <li><strong>ä¿æŒé•¿è¿æ¥çŠ¶æ€ï¼Œå®æ—¶æ€§</strong>ã€‚HTTPè¦ä¸æ–­å‘é€è¯·æ±‚æ¥ä¿æŒè¿æ¥ï¼Œå¦åˆ™æœåŠ¡å™¨å“åº”å®Œå®¢æˆ·ç«¯å°±æ–­å¼€è¿æ¥äº†</li></ul> <br> <h3 id="_2-4-åŸºäºtcp"><a href="#_2-4-åŸºäºtcp" class="header-anchor">#</a> 2.4 åŸºäºTCP</h3> <p>é¦–å…ˆæ¥é˜æ˜ç»“è®ºï¼š</p> <p><strong>WebSocketå’ŒHTTPéƒ½æ˜¯åŸºäºTCPåè®®çš„ï¼Œå¦‚æœè¦ç”¨UDPå¯ä»¥ç”¨ <a href="https://webrtc.org/" target="_blank" rel="noopener noreferrer">WebRTCåè®®<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p> <blockquote><p>å‚è§å®˜æ–¹æ–‡æ¡£ <a href="https://tools.ietf.org/html/draft-abarth-thewebsocketprotocol-00" target="_blank" rel="noopener noreferrer">Relationship to TCP and HTTP<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ç›¸å…³é—®é¢˜å‚è§stackoverflow ğŸ”— <a href="https://stackoverflow.com/questions/4657033/javascript-websockets-with-udp" target="_blank" rel="noopener noreferrer">WebSockets with UDP<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>1.7  Relationship to TCP and HTTP</p> <p><em>This section is non-normative.</em></p> <p>The WebSocket protocol is an independent TCP-based protocol. Its
only relationship to HTTP is that its handshake is interpreted by
HTTP servers as an Upgrade request.</p> <p>Based on the expert recommendation of the IANA, the WebSocket
protocol by default uses port 80 for regular WebSocket connections
and port 443 for WebSocket connections tunneled over TLS.</p> <p>WebSocket åè®®æ˜¯<font color="red"><strong>åŸºäº TCP çš„ç‹¬ç«‹åè®®</strong></font>ã€‚å…¶ä¸HTTP çš„å”¯ä¸€å…³ç³»æ˜¯ï¼Œå…¶æ¡æ‰‹ç”±HTTP æœåŠ¡å™¨ä½œä¸ºå‡çº§è¯·æ±‚ã€‚æ ¹æ®IANAçš„ä¸“å®¶å»ºè®®ï¼ŒWebSocketåè®®é»˜è®¤ä½¿ç”¨ç«¯å£80ä½œä¸ºå¸¸è§„çš„WebSocketè¿æ¥ï¼Œä½¿ç”¨ç«¯å£443ä½œä¸ºé€šè¿‡TLSéš§é“çš„WebSocketè¿æ¥ã€‚</p> <br> <h3 id="_2-5-æˆç†Ÿçš„websocketæœåŠ¡å™¨ç«¯å®ç°"><a href="#_2-5-æˆç†Ÿçš„websocketæœåŠ¡å™¨ç«¯å®ç°" class="header-anchor">#</a> 2.5 æˆç†Ÿçš„WebSocketæœåŠ¡å™¨ç«¯å®ç°</h3> <p>ç›®å‰ä¸€äº›æ¯”è¾ƒæˆç†Ÿçš„ WebSocket æœåŠ¡å™¨ç«¯å®ç°,å¦‚ï¼š</p> <ul><li>Kaazing WebSocket Gateway â€” ä¸€ä¸ª Java å®ç°çš„ WebSocket Server</li> <li>mod_pywebsocket â€” ä¸€ä¸ª Python å®ç°çš„ WebSocket Server</li> <li>Netty â€”ä¸€ä¸ª Java å®ç°çš„ç½‘ç»œæ¡†æ¶å…¶ä¸­åŒ…æ‹¬äº†å¯¹ WebSocket çš„æ”¯æŒ</li> <li>node.js â€”ä¸€ä¸ª Server ç«¯çš„ JavaScript æ¡†æ¶æä¾›äº†å¯¹ WebSocket çš„æ”¯æŒ</li></ul> <br> <hr> <h2 id="_3-websocketåè®®é€šä¿¡åŸç†"><a href="#_3-websocketåè®®é€šä¿¡åŸç†" class="header-anchor">#</a> 3. WebSocketåè®®é€šä¿¡åŸç†</h2> <p><strong>HTTPåè®®ï¼š</strong></p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192316.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>å»¶æ—¶æ—¶é—´é•¿ï¼Œè€Œä¸”åªèƒ½æ˜¯å•å‘é€šä¿¡ï¼Œå•æ¬¡é€šä¿¡å®Œï¼Œè¿æ¥å°±æ–­å¼€äº†ã€‚</p> <br> <h3 id="_3-1-åè®®å‡çº§"><a href="#_3-1-åè®®å‡çº§" class="header-anchor">#</a> 3.1 åè®®å‡çº§</h3> <p><strong>WebSocketåè®®æ˜¯å»ºç«‹åœ¨HTTPåè®®åŸºç¡€ä¹‹ä¸Šçš„ï¼Œåœ¨å»ºç«‹HTTPåè®®æ—¶ï¼Œä¼ è¾“å±‚å¦‚æœæ˜¯TCPåè®®å°±å¿…ç„¶ç»å†è¿‡äº†ä¸‰æ¬¡æ¡æ‰‹</strong></p> <p>å»ºç«‹TCPè¿æ¥ä¹‹åï¼Œå¼€å§‹å»ºç«‹WebSocketè¿æ¥ï¼Œä¸Šæ–‡è¯´è¿‡WebSocketè¿æ¥åªéœ€ä¸€æ¬¡æˆåŠŸæ¡æ‰‹å³å¯å»ºç«‹ã€‚æ¡æ‰‹è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå›¾ç‰‡æ¥è‡ªäº’è”ç½‘ï¼‰ï¼š</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192321.jpeg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p><strong>1. é¦–å…ˆå®¢æˆ·ç«¯ä¼šå‘é€ä¸€ä¸ªæ¡æ‰‹åŒ…</strong></p> <p>è¿™é‡Œå°±ä½“ç°å‡ºäº†WebSocketä¸Httpåè®®çš„è”ç³»ï¼Œæ¡æ‰‹åŒ…çš„æŠ¥æ–‡æ ¼å¼å¿…é¡»ç¬¦åˆHTTPæŠ¥æ–‡æ ¼å¼çš„è§„èŒƒã€‚å…¶ä¸­ï¼š</p> <ul><li>æ–¹æ³•å¿…é¡»ä½GETæ–¹æ³•</li> <li>HTTPç‰ˆæœ¬ä¸èƒ½ä½äº1.1</li> <li>å¿…é¡»åŒ…å«Upgradeå¤´éƒ¨ï¼Œå€¼å¿…é¡»ä¸ºwebsocket</li> <li>å¿…é¡»åŒ…å«Sec-WebSocket-Keyå¤´éƒ¨ï¼Œå€¼æ˜¯ä¸€ä¸ªBase64ç¼–ç çš„16å­—èŠ‚éšæœºå­—ç¬¦ä¸²ã€‚</li> <li>å¿…é¡»åŒ…å«Sec-WebSocket-Versionå¤´éƒ¨ï¼Œå€¼å¿…é¡»ä¸º13</li> <li>å…¶ä»–å¯é€‰é¦–éƒ¨å¯ä»¥å‚è€ƒï¼š<a href="https://tools.ietf.org/html/rfc6455#section-4.1" target="_blank" rel="noopener noreferrer">https://tools.ietf.org/html/rfc6455#section-4.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><strong>2. æœåŠ¡ç«¯éªŒè¯å®¢æˆ·ç«¯çš„æ¡æ‰‹åŒ…ç¬¦åˆè§„èŒƒä¹‹åä¹Ÿä¼šå‘é€ä¸€ä¸ªæ¡æ‰‹åŒ…ç»™å®¢æˆ·ç«¯ã€‚</strong></p> <p>æ ¼å¼å¦‚ä¸‹ï¼š</p> <ul><li>å¿…é¡»åŒ…å«Connectionå¤´éƒ¨ï¼Œå€¼å¿…é¡»ä¸ºUpgrade</li> <li>å¿…é¡»åŒ…å«ä¸€ä¸ªUpgradeå¤´éƒ¨ï¼Œå€¼å¿…é¡»ä¸ºwebsocket</li> <li>å¿…é¡»åŒ…å«ä¸€ä¸ªSec-Websocket-Acceptå¤´éƒ¨ï¼Œå€¼æ˜¯æ ¹æ®å¦‚ä¸‹è§„åˆ™è®¡ç®—çš„ï¼š</li></ul> <p>é¦–å…ˆå°†ä¸€ä¸ªå›ºå®šçš„å­—ç¬¦ä¸²</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token number">258</span><span class="token constant">EAFA5</span><span class="token operator">-</span><span class="token constant">E914</span><span class="token operator">-</span><span class="token number">47D</span>A<span class="token operator">-</span><span class="token number">95</span><span class="token constant">CA</span><span class="token operator">-</span><span class="token constant">C5AB0DC85B11</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ‹¼æ¥åˆ°Sec-WebSocket-Keyå¯¹åº”å€¼çš„åé¢ã€‚å¯¹æ‹¼æ¥åçš„å­—ç¬¦ä¸²è¿›è¡Œä¸€æ¬¡SHA-1è®¡ç®—ï¼Œå°†è®¡ç®—ç»“æœè¿›è¡ŒBase-64ç¼–ç </p> <p><strong>3. å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„æ¡æ‰‹åŒ…ä¹‹åï¼ŒéªŒè¯æŠ¥æ–‡æ ¼å¼æ—¶å€™ç¬¦åˆè§„èŒƒï¼Œä»¥2ä¸­åŒæ ·çš„æ–¹å¼è®¡ç®—Sec-WebSocket-Acceptå¹¶ä¸æœåŠ¡ç«¯æ¡æ‰‹åŒ…é‡Œçš„å€¼è¿›è¡Œæ¯”å¯¹</strong></p> <p>å…¶ä¸­ä»»ä½•ä¸€æ­¥ä¸é€šè¿‡åˆ™ä¸èƒ½å»ºç«‹WebSocketè¿æ¥ã€‚</p> <hr> <p>å®¢æˆ·ç«¯å‘é€<code>Upgrade</code>è¯·æ±‚å¤´æ¥å‘ŠçŸ¥æœåŠ¡ç«¯åè®®å‡çº§ï¼Œæƒ³è¦å»ºç«‹ä¸€ä¸ª WebSocket è¿æ¥ã€‚</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192326.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p><strong>ã€101çŠ¶æ€ç ã€‘</strong></p> <p>å½“å®¢æˆ·ç«¯åœ¨è¯·æ±‚é‡Œä½¿ç”¨<code>Upgrade</code>æŠ¥å¤´ï¼Œé€šçŸ¥æœåŠ¡å™¨å®ƒæƒ³æ”¹ç”¨é™¤HTTPåè®®ä¹‹å¤–çš„å…¶ä»–åè®®æ—¶ï¼Œå®¢æˆ·ç«¯å°†è·å¾—æ­¤å“åº”ä»£ç ã€‚<strong>101</strong> å“åº”ä»£ç è¡¨ç¤ºâ€œè¡Œï¼Œæˆ‘ç°åœ¨æ”¹ç”¨å¦ä¸€ä¸ªåè®®äº†â€ã€‚</p> <p>é€šå¸¸HTTPå®¢æˆ·ç«¯ä¼šåœ¨æ”¶åˆ°æœåŠ¡å™¨å‘æ¥çš„101å“åº”å<strong>å…³é—­ä¸æœåŠ¡å™¨çš„TCPè¿æ¥</strong>ã€‚101å“åº”ä»£ç æ„å‘³ç€ï¼Œè¯¥å®¢æˆ·ç«¯ä¸å†æ˜¯ä¸€ä¸ªHTTPå®¢æˆ·ç«¯ï¼Œè€Œå°†æˆä¸ºå¦ä¸€ç§å®¢æˆ·ç«¯ã€‚</p> <br> <h3 id="_3-2-å»ºç«‹websocketè¿æ¥"><a href="#_3-2-å»ºç«‹websocketè¿æ¥" class="header-anchor">#</a> 3.2 å»ºç«‹WebSocketè¿æ¥</h3> <p>åœ¨å®¢æˆ·ç«¯å»ºç«‹ä¸€ä¸ª WebSocket è¿æ¥éå¸¸ç®€å•ï¼šè¦è¿æ¥åˆ°ç«¯ç‚¹ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªæ–°çš„ WebSocket å®ä¾‹ï¼Œä¸ºæ–°å¯¹è±¡æä¾›ä¸€ä¸ª URLï¼Œè¯¥ URL è¡¨ç¤ºè¦è¿æ¥åˆ°çš„ç«¯ç‚¹</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'ws://localhost:9000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¯·æ±‚çš„ URL æ˜¯<code>ws://</code>æˆ–è€… <code>wss://</code>å¼€å¤´çš„ï¼Œè€Œä¸æ˜¯ <code>httP://</code> æˆ–è€… <code>https://</code></p> <br> <h3 id="_3-3-æ¡æ‰‹"><a href="#_3-3-æ¡æ‰‹" class="header-anchor">#</a> 3.3 æ¡æ‰‹</h3> <p>WebSocketåè®®çš„å»ºç«‹æ˜¯åŸºäºHTTPåè®®ä¹‹ä¸Šçš„ï¼Œå…ˆå»ºç«‹HTTPåè®®ï¼Œç„¶åé€šè¿‡å‘é€<code>101</code>çŠ¶æ€ç ï¼Œä½¿ç”¨<code>Upgrade</code>æŠ¥å¤´å‡çº§ä¸º<strong>WebSocket</strong>åè®®</p> <p>WebSocket è¿æ¥æ˜¯åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„åˆå§‹æ¡æ‰‹æœŸé—´ä» HTTP åè®®å‡çº§åˆ° WebSocket åè®®å»ºç«‹çš„</p> <p>æ­¤æ—¶ï¼ŒHTTP è¿æ¥æ–­å¼€ï¼Œå¹¶ç”± WebSocket è¿æ¥é€šè¿‡ç›¸åŒçš„åŸºç¡€ TCP/IP è¿æ¥æ›¿æ¢ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒWebSocket è¿æ¥ä½¿ç”¨ä¸ HTTP ï¼ˆ80ï¼‰ å’Œ HTTPS ï¼ˆ443ï¼‰ ç›¸åŒçš„ç«¯å£ã€‚</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192336.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>WebSocketåè®®æœ‰ä¸¤éƒ¨åˆ†ï¼š<strong>æ¡æ‰‹</strong>å’Œ<strong>æ•°æ®ä¼ è¾“</strong>ï¼Œæ¡æ‰‹æ˜¯åŸºäºHTTPåè®®çš„</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192346.webp" alt=""></p> <h3 id="_3-4-è¯·æ±‚æ•°æ®"><a href="#_3-4-è¯·æ±‚æ•°æ®" class="header-anchor">#</a> 3.4 è¯·æ±‚æ•°æ®</h3> <p>å®¢æˆ·ç«¯requestè¯·æ±‚å¤´ï¼š</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code>GET ws://localhostchat HTTP/1.1
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">localhost</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade</span><span class="token punctuation">:</span> <span class="token header-value">websocket  //è¡¨ç¤ºè¦å‡çº§åˆ°websocketåè®®</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">Upgrade</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Extensions</span><span class="token punctuation">:</span> <span class="token header-value">permessage-deflate;</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Key</span><span class="token punctuation">:</span> <span class="token header-value">5fTJ1LTuh3RKjSJxydyifQ==		// ä¸å“åº”å¤´ Sec-WebSocket-Accept ç›¸å¯¹åº”</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Version</span><span class="token punctuation">:</span> <span class="token header-value">13	//è¡¨ç¤ºwebsocketåè®®çš„ç‰ˆæœ¬	</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>æœåŠ¡ç«¯responseå“åº”å¤´ï¼š</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">101</span> <span class="token reason-phrase string">Switching Protocols</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade</span><span class="token punctuation">:</span> <span class="token header-value">websocket</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">Upgrade</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Accept</span><span class="token punctuation">:</span> <span class="token header-value">ZUip34t+bCjhkvxxwhmdEOyx9hE=</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Extensions</span><span class="token punctuation">:</span> <span class="token header-value">permessage-deflate;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ã€å­—æ®µè¯´æ˜ã€‘</p> <table><thead><tr><th>å¤´åç§°</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td>Connection: Upgrade</td> <td>è¡¨ç¤ºè¯¥HTTPè¯·æ±‚æ˜¯ä¸€ä¸ªäººåè®®å‡çº§è¯·æ±‚</td></tr> <tr><td>Upgrade: websocket</td> <td>åè®®å‡çº§ä¸ºWebSocketåè®®</td></tr> <tr><td>Sec-WebSocket-Version: 13</td> <td>è¡¨ç¤ºwebsocketåè®®çš„ç‰ˆæœ¬</td></tr> <tr><td>Sec-WebSocket-Key</td> <td><strong>ä¸å“åº”å¤´ Sec-WebSocket-Accept ç›¸å¯¹åº”ï¼Œç”¨æ¥å”¯ä¸€æ ‡è¯†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨</strong></td></tr> <tr><td>Sec-WebSocket-Extensions</td> <td>åè®®æ‹“å±•</td></tr></tbody></table> <p>å¦‚æœä¸€æ¬¡å‘é€çš„æ¶ˆæ¯è¿‡é•¿ï¼ŒWebSocketçš„å•ä¸ªæ¶ˆæ¯å¯è¢«åˆ†å‰²ä¸ºå¤šä¸ªæ•°æ®å¸§æ¥åˆ†ç»„å‘é€ï¼Œç›´è‡³æœ«å°¾ä¸º<code>FIN</code>æ ‡å¿—ä½ (PS:æ—¢ç„¶çœ‹åˆ°äº†FINæ ‡å¿—ä½ï¼Œè¯´æ˜WebSocketåè®®æ˜¯ä¾æ®TCPçš„)</p> <blockquote><p>æ¥è‡ªç»´åŸºç™¾ç§‘:</p> <p>Once the connection is established, the client and server can send WebSocket data or text frames back and forth in <a href="https://en.wikipedia.org/wiki/Duplex_(telecommunications)" target="_blank" rel="noopener noreferrer">full-duplex<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> mode. The data is minimally framed, with a small header followed by <a href="https://en.wikipedia.org/wiki/Payload_(computing)" target="_blank" rel="noopener noreferrer">payload<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.[<a href="https://en.wikipedia.org/wiki/WebSocket#cite_note-37" target="_blank" rel="noopener noreferrer">36]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> WebSocket transmissions are described as &quot;messages&quot;, where a single message can optionally be split across several data frames. This can allow for sending of messages where initial data is available but the complete length of the message is unknown (it sends one data frame after another until the end is reached and marked with the FIN bit). With extensions to the protocol, this can also be used for multiplexing several streams simultaneously (for instance to avoid monopolizing use of a socket for a single large payload).[<a href="https://en.wikipedia.org/wiki/WebSocket#cite_note-38" target="_blank" rel="noopener noreferrer">37]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>ä¸€æ—¦å»ºç«‹äº†è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥åœ¨å…¨åŒå·¥æ¨¡å¼ä¸‹æ¥å›å‘é€WebSocketæ•°æ®æˆ–æ–‡æœ¬å¸§ã€‚WebSocket ä¼ è¾“è¢«æè¿°ä¸º &quot;æ¶ˆæ¯&quot;ï¼Œå…¶ä¸­å•ä¸ªæ¶ˆæ¯å¯ä»¥é€‰æ‹©åœ¨å¤šä¸ªæ•°æ®å¸§ä¸­åˆ†å‰²ï¼Œè¿™å…è®¸å‘é€åˆå§‹æ•°æ®å¯ç”¨ä½†æ¶ˆæ¯çš„å®Œæ•´é•¿åº¦æœªçŸ¥çš„æ¶ˆæ¯ï¼ˆå®ƒå‘é€ä¸€ä¸ªåˆä¸€ä¸ªæ•°æ®å¸§ï¼Œç›´åˆ°åˆ°è¾¾ç»ˆç‚¹å¹¶æ ‡æœ‰ FIN ä½ï¼‰ã€‚é€šè¿‡åè®®çš„æ‰©å±•ï¼Œè¿™è¿˜å¯ç”¨äºåŒæ—¶å¤šè·¯å¤ç”¨å¤šä¸ªæµï¼ˆä¾‹å¦‚ï¼Œé¿å…å¯¹å•ä¸ªå¤§å‹æœ‰æ•ˆè´Ÿè½½çš„å¥—æ¥å­—è¿›è¡Œç‹¬å ä½¿ç”¨ï¼‰ã€‚</p> <br> <h2 id="_4-å®¢æˆ·ç«¯é€šä¿¡"><a href="#_4-å®¢æˆ·ç«¯é€šä¿¡" class="header-anchor">#</a> 4. å®¢æˆ·ç«¯é€šä¿¡</h2> <h3 id="_4-1-websocketå¯¹è±¡"><a href="#_4-1-websocketå¯¹è±¡" class="header-anchor">#</a> 4.1 WebSocketå¯¹è±¡</h3> <p>â€‹	åˆ›å»ºWebSocketå¯¹è±¡ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è¯·æ±‚çš„åœ°å€</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>å‚æ•°urlæ ¼å¼ï¼š<code>ws://ipåœ°å€:ç«¯å£å·/èµ„æºåç§°</code></p></blockquote> <h3 id="_4-2-websocketäº‹ä»¶"><a href="#_4-2-websocketäº‹ä»¶" class="header-anchor">#</a> 4.2 WebSocketäº‹ä»¶</h3> <p>WebSocketå¯¹è±¡çš„ç›¸å…³äº‹ä»¶ï¼š</p> <table><thead><tr><th>äº‹ä»¶</th> <th>äº‹ä»¶å¤„ç†ç¨‹åº</th> <th>æè¿°</th></tr></thead> <tbody><tr><td>open</td> <td>websocketå¯¹è±¡.onopen</td> <td>è¿æ¥å»ºç«‹æ—¶è§¦å‘</td></tr> <tr><td>message</td> <td>websocketå¯¹è±¡.onmessage</td> <td>å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡ç«¯æ•°æ®æ—¶è§¦å‘</td></tr> <tr><td>error</td> <td>websocketå¯¹è±¡.onerror</td> <td>é€šä¿¡å‘ç”Ÿé”™è¯¯æ˜¯è§¦å‘</td></tr> <tr><td>close</td> <td>websocketå¯¹è±¡.onclose</td> <td>è¿æ¥å…³é—­æ—¶è§¦å‘</td></tr></tbody></table> <h3 id="_4-3-websocketæ–¹æ³•"><a href="#_4-3-websocketæ–¹æ³•" class="header-anchor">#</a> 4.3 WebSocketæ–¹æ³•</h3> <p>WebSocketå¯¹è±¡çš„ç›¸å…³æ–¹æ³•ï¼š</p> <p><code>send()</code>ï¼šä½¿ç”¨è¿æ¥å‘é€æ•°æ®</p> <br> <h2 id="_5-æœåŠ¡ç«¯é€šä¿¡"><a href="#_5-æœåŠ¡ç«¯é€šä¿¡" class="header-anchor">#</a> 5. æœåŠ¡ç«¯é€šä¿¡</h2> <p>Java Websocketåº”ç”¨ç”±ä¸€ç³»åˆ—çš„ <code>WebSocketEndpoint</code>ç»„æˆã€‚ <code>Endpoint</code>æ˜¯ä¸€ä¸ªjavaå¯¹è±¡ï¼Œä»£è¡¨ WebSocketé“¾æ¥çš„ä¸€ç«¯ã€‚å¯¹äºæœåŠ¡ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥è§†ä¸ºå¤„ç†å…·ä½“WebSocketæ¶ˆæ¯çš„æ¥å£ï¼Œå°±åƒServletä¹‹ä¸HTTPè¯·æ±‚ä¸€æ ·ã€‚
æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å®šä¹‰ Endpointï¼š</p> <ul><li>ç¬¬ä¸€ç§æ˜¯ç¼–ç¨‹å¼ï¼Œå³ç»§æ‰¿ç±» <code>javax.websocket</code>ï¼ŒEndpointå¹¶å®ç°å…¶æ–¹æ³•</li> <li>ç¬¬äºŒç§æ˜¯æ³¨è§£å¼ï¼Œå³å®šä¹‰ä¸€ä¸ª<code>POJO</code>ï¼Œå¹¶æ·»åŠ  <code>ServerEndpoint</code>ç›¸å…³æ³¨è§£</li></ul> <p><code>Endpoint</code>å®ä¾‹åœ¨ WebSocketæ¡æ‰‹æ—¶åˆ›å»ºï¼Œå¹¶åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é“¾æ¥è¿‡ç¨‹ä¸­æœ‰æ•ˆï¼Œæœ€ååœ¨é“¾æ¥å…³é—­æ—¶ç»“æŸã€‚åœ¨Endpointæ¥å£ä¸­æ˜ç¡®å®šä¹‰äº†ä¸å…¶ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„æ–¹æ³•ï¼Œè§„èŒƒå®ç°è€…ç¡®ä¿ç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µè°ƒç”¨å®ä¾‹çš„ç›¸å…³æ–¹æ³•ã€‚ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å¦‚ä¸‹ï¼š</p> <table><thead><tr><th>æ–¹æ³•</th> <th>å«ä¹‰</th> <th>æ³¨è§£</th></tr></thead> <tbody><tr><td>onClose</td> <td>å½“ä¼šè¯å¼€å¯æ—¶è°ƒç”¨</td> <td>@OoClose</td></tr> <tr><td>onOpen</td> <td>å½“å¼€å¯ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨æ¡æ‰‹æˆåŠŸåè°ƒç”¨</td> <td>@OnOpen</td></tr> <tr><td>onError</td> <td>è¿æ¥è§„ç¨‹ä¸­äº§ç”Ÿå¼‚å¸¸</td> <td>@OnError</td></tr> <tr><td>OnMessage</td> <td>å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡ç«¯æ•°æ®æ—¶è§¦å‘</td> <td>@OnMessage</td></tr></tbody></table> <p><strong>æœåŠ¡ç«¯å¦‚ä½•æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ•°æ®å‘¢ï¼Ÿ</strong></p> <p>é€šè¿‡ä¸º Sessionæ·»åŠ  MessageHandleræ¶ˆæ¯å¤„ç†å™¨æ¥æ¥æ”¶æ¶ˆæ¯ï¼Œå½“é‡‡ç”¨æ³¨è§£æ–¹å¼å®šä¹‰ Endpointæ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>@OnMessage</code>æ³¨è§£æŒ‡å®šæ¥æ”¶æ¶ˆæ¯çš„æ–¹æ³•ã€‚</p> <p><strong>æœåŠ¡ç«¯å¦‚ä½•æ¨é€æ•°æ®ç»å®¢æˆ·ç«¯å‘¢ï¼Ÿ</strong></p> <p>å‘é€æ¶ˆæ¯åˆ™ç”± RemoteEndpointå®Œæˆï¼Œå…¶å®ä¾‹ç”± sessionç»´æŠ¤ï¼Œæ ¹æ®ä½¿ç”¨æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Session.getBasicRemote</code>è·å–åŒæ­¥æ¶ˆæ¯å‘é€çš„å®ä¾‹ï¼Œç„¶åè°ƒç”¨å…¶ <code>sendXxx()</code>æ–¹æ³•å°±å¯ä»¥å‘é€æ¶ˆæ¯ï¼Œå¯ä»¥é€šè¿‡<code>Session.getAsyncRemote</code>è·å–å¼‚æ­¥æ¶ˆæ¯å‘é€å®ä¾‹</p> <h3 id="å¿ƒè·³ä¿æ´»"><a href="#å¿ƒè·³ä¿æ´»" class="header-anchor">#</a> å¿ƒè·³ä¿æ´»</h3> <p>åœ¨å®é™…ä½¿ç”¨ WebSocket ä¸­ï¼Œé•¿æ—¶é—´ä¸é€šæ¶ˆæ¯å¯èƒ½ä¼šå‡ºç°ä¸€äº›è¿æ¥ä¸ç¨³å®šçš„æƒ…å†µï¼Œè¿™äº›æœªçŸ¥æƒ…å†µå¯¼è‡´çš„è¿æ¥ä¸­æ–­ä¼šå½±å“å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹å‰çš„é€šä¿¡ï¼Œ</p> <p>ä¸ºäº†é˜²æ­¢è¿™ç§çš„æƒ…å†µçš„å‡ºç°ï¼Œæœ‰ä¸€ç§å¿ƒè·³ä¿æ´»çš„æ–¹æ³•ï¼šå®¢æˆ·ç«¯å°±åƒå¿ƒè·³ä¸€æ ·æ¯éš”å›ºå®šçš„æ—¶é—´å‘é€ä¸€æ¬¡ pingï¼Œæ¥å‘Šè¯‰æœåŠ¡å™¨ï¼Œæˆ‘è¿˜æ´»ç€ï¼Œè€ŒæœåŠ¡å™¨ä¹Ÿä¼šè¿”å› pongï¼Œæ¥å‘Šè¯‰å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨è¿˜æ´»ç€ã€‚ping/pong å…¶å®æ˜¯ä¸€æ¡ä¸ä¸šåŠ¡æ— å…³çš„å‡æ¶ˆæ¯ï¼Œä¹Ÿç§°ä¸ºå¿ƒè·³åŒ…ã€‚</p> <p>å¯ä»¥åœ¨è¿æ¥æˆåŠŸä¹‹åï¼Œæ¯éš”ä¸€ä¸ªå›ºå®šæ—¶é—´å‘é€å¿ƒè·³åŒ…ï¼Œæ¯”å¦‚ 60s:</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'è¿™æ˜¯ä¸€æ¡å¿ƒè·³åŒ…æ¶ˆæ¯'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">60000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192359.webp" alt=""></p> <p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œå¤§å®¶åº”è¯¥å¯¹ WebSocket æœ‰äº†ä¸€å®šè®¤è¯†ï¼Œå…¶å®å¹¶ä¸ç¥ç§˜ï¼Œè¿™é‡Œå¯¹æ–‡ç« å†…å®¹ç®€å•æ€»ç»“ä¸€ä¸‹ã€‚å½“åˆ›å»º WebSocket å®ä¾‹çš„æ—¶å€™ï¼Œä¼šå‘ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œè¯·æ±‚æŠ¥æ–‡ä¸­æœ‰ä¸ªç‰¹æ®Šçš„å­—æ®µ Upgradeï¼Œç„¶åè¿™ä¸ªè¿æ¥ä¼šç”± HTTP åè®®è½¬æ¢ä¸º WebSocket åè®®ï¼Œè¿™æ ·å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹äº†å…¨åŒå·¥é€šä¿¡ï¼Œé€šè¿‡ WebSocket çš„ send æ–¹æ³•å’Œ onmessage äº‹ä»¶å°±å¯ä»¥é€šè¿‡è¿™æ¡é€šä¿¡è¿æ¥äº¤æ¢ä¿¡æ¯ã€‚</p> <br> <h2 id="_6-websocketç¤ºä¾‹"><a href="#_6-websocketç¤ºä¾‹" class="header-anchor">#</a> 6. WebSocketç¤ºä¾‹</h2> <p><strong>1. é¦–å…ˆåˆ›å»ºmavenå·¥ç¨‹</strong></p> <p>ã€ç›®å½•ç»“æ„å¦‚å›¾ã€‘</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">WebSocketChatDemo</span>
 â”œâ”€â”€ pom<span class="token punctuation">.</span>xml
 â”œâ”€â”€ src
 â”‚   â””â”€â”€ main
 â”‚       â”œâ”€â”€ java
 â”‚       â”‚   â””â”€â”€ top<span class="token punctuation">.</span>iqqcode
 â”‚	             â””â”€â”€ <span class="token class-name">WebSocketTest</span><span class="token punctuation">.</span>java
 â”‚       â””â”€â”€ webapp
 â”‚           â”œâ”€â”€ index<span class="token punctuation">.</span>html
 â”‚           â””â”€â”€ <span class="token constant">WEB</span><span class="token operator">-</span><span class="token constant">INF</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>2. pomä¾èµ–</strong></p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>javax<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>javaee-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- https://mvnrepository.com/artifact/org.java-websocket/Java-WebSocket --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.java-websocket<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>Java-WebSocket<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>3. æœåŠ¡ç«¯ä»£ç -WebSocketTest.java</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">CopyOnWriteArraySet</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>atomic<span class="token punctuation">.</span></span><span class="token class-name">AtomicInteger</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>websocket<span class="token punctuation">.</span>server<span class="token punctuation">.</span></span><span class="token class-name">ServerEndpoint</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @ServerEndpoint æ³¨è§£æ˜¯ä¸€ä¸ªç±»å±‚æ¬¡çš„æ³¨è§£ï¼Œå®ƒçš„åŠŸèƒ½ä¸»è¦æ˜¯å°†ç›®å‰çš„ç±»å®šä¹‰æˆä¸€ä¸ªwebsocketæœåŠ¡å™¨ç«¯,
 * æ³¨è§£çš„å€¼å°†è¢«ç”¨äºç›‘å¬ç”¨æˆ·è¿æ¥çš„ç»ˆç«¯è®¿é—®URLåœ°å€,å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡è¿™ä¸ªURLæ¥è¿æ¥åˆ°WebSocketæœåŠ¡å™¨ç«¯
 */</span>
<span class="token annotation punctuation">@ServerEndpoint</span><span class="token punctuation">(</span><span class="token string">&quot;/websocket&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSocketTest</span> <span class="token punctuation">{</span>
    <span class="token comment">// é™æ€å˜é‡ï¼Œç”¨æ¥è®°å½•å½“å‰åœ¨çº¿è¿æ¥æ•°ã€‚åº”è¯¥æŠŠå®ƒè®¾è®¡æˆçº¿ç¨‹å®‰å…¨çš„ã€‚</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">AtomicInteger</span> onlineCount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// (ç¾¤èŠ) ConcurrentåŒ…çš„çº¿ç¨‹å®‰å…¨Setï¼Œç”¨æ¥å­˜æ”¾æ¯ä¸ªå®¢æˆ·ç«¯å¯¹åº”çš„MyWebSocketå¯¹è±¡ã€‚</span>
    <span class="token comment">// (ç§èŠ) è‹¥è¦å®ç°æœåŠ¡ç«¯ä¸å•ä¸€å®¢æˆ·ç«¯é€šä¿¡çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨Mapæ¥å­˜æ”¾ï¼Œå…¶ä¸­Keyå¯ä»¥ä¸ºç”¨æˆ·æ ‡è¯†</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">CopyOnWriteArraySet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebSocketTest</span><span class="token punctuation">&gt;</span></span> webSocketSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CopyOnWriteArraySet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebSocketTest</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// ä¸æŸä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ä¼šè¯ï¼Œéœ€è¦é€šè¿‡å®ƒæ¥ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®</span>
    <span class="token keyword">private</span> <span class="token class-name">Session</span> session<span class="token punctuation">;</span>

    <span class="token comment">/**
     * è¿æ¥å»ºç«‹æˆåŠŸè°ƒç”¨çš„æ–¹æ³•
     *
     * @param session å¯é€‰çš„å‚æ•°ã€‚sessionä¸ºä¸æŸä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ä¼šè¯ï¼Œéœ€è¦é€šè¿‡å®ƒæ¥ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®
     */</span>
    <span class="token annotation punctuation">@OnOpen</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>session <span class="token operator">=</span> session<span class="token punctuation">;</span>
        webSocketSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//åŠ å…¥setä¸­</span>
        <span class="token function">addOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//åœ¨çº¿æ•°åŠ 1</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ‰æ–°è¿æ¥åŠ å…¥ï¼å½“å‰åœ¨çº¿äººæ•°ä¸º&quot;</span> <span class="token operator">+</span> <span class="token function">getOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯åè°ƒç”¨çš„æ–¹æ³•
     *
     * @param message å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯
     * @param session å¯é€‰çš„å‚æ•°
     */</span>
    <span class="token annotation punctuation">@OnMessage</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span> <span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯:&quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ç¾¤å‘æ¶ˆæ¯</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">WebSocketTest</span> item <span class="token operator">:</span> webSocketSet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                item<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * è¿æ¥å…³é—­è°ƒç”¨çš„æ–¹æ³•
     */</span>
    <span class="token annotation punctuation">@OnClose</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        webSocketSet<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//ä»setä¸­åˆ é™¤</span>
        <span class="token function">subOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//åœ¨çº¿æ•°å‡1</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æœ‰ä¸€è¿æ¥å…³é—­ï¼å½“å‰åœ¨çº¿äººæ•°ä¸º&quot;</span> <span class="token operator">+</span> <span class="token function">getOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å‘ç”Ÿé”™è¯¯æ—¶è°ƒç”¨
     *
     * @param session
     * @param error
     */</span>
    <span class="token annotation punctuation">@OnError</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å‘ç”Ÿé”™è¯¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        error<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * å‘é€ä¿¡æ¯æ–¹æ³•
     * è¿™ä¸ªæ–¹æ³•ä¸ä¸Šé¢å‡ ä¸ªæ–¹æ³•ä¸ä¸€æ ·ã€‚æ²¡æœ‰ç”¨æ³¨è§£ï¼Œæ˜¯æ ¹æ®è‡ªå·±éœ€è¦æ·»åŠ çš„æ–¹æ³•
     *
     * @param message
     * @throws IOException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">getBasicRemote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendText</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//this.session.getAsyncRemote().sendText(message);</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * (çº¿ç¨‹å®‰å…¨) è·å–åœ¨çº¿äººæ•°
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">AtomicInteger</span> <span class="token function">getOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> onlineCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// (çº¿ç¨‹å®‰å…¨) åœ¨çº¿äººæ•° +1</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">addOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">WebSocketTest</span><span class="token punctuation">.</span>onlineCount<span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// (çº¿ç¨‹å®‰å…¨) åœ¨çº¿äººæ•° -1</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">subOnlineCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">WebSocketTest</span><span class="token punctuation">.</span>onlineCount<span class="token punctuation">.</span><span class="token function">decrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br></div></div><p><strong>4. é¡µé¢åŠå®¢æˆ·ç«¯ä»£ç </strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>ChatDemo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>ã€€ã€€ã€€ã€€ã€€ã€€
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no<span class="token punctuation">'</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>viewport<span class="token punctuation">'</span></span><span class="token punctuation">/&gt;</span></span>
    ã€€ã€€ã€€ã€€
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html; charset=utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
Welcome<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>å‘é€æ¶ˆæ¯<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">closeWebSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>å…³é—­WebSocketè¿æ¥<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--å®¢æˆ·ç«¯ä»£ç --&gt;</span>    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> websocket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">//åˆ¤æ–­å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒWebSocket</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'WebSocket'</span> <span class="token keyword">in</span> window<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        websocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;ws://localhost:8080/websocket&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'å½“å‰æµè§ˆå™¨ Not support websocket'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//è¿æ¥å‘ç”Ÿé”™è¯¯çš„å›è°ƒæ–¹æ³•</span>
    websocket<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setMessageInnerHTML</span><span class="token punctuation">(</span><span class="token string">&quot;WebSocketè¿æ¥å‘ç”Ÿé”™è¯¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">//è¿æ¥æˆåŠŸå»ºç«‹çš„å›è°ƒæ–¹æ³•</span>
    websocket<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setMessageInnerHTML</span><span class="token punctuation">(</span><span class="token string">&quot;WebSocketè¿æ¥æˆåŠŸ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//æ¥æ”¶åˆ°æ¶ˆæ¯çš„å›è°ƒæ–¹æ³•</span>
    websocket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setMessageInnerHTML</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//è¿æ¥å…³é—­çš„å›è°ƒæ–¹æ³•</span>
    websocket<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setMessageInnerHTML</span><span class="token punctuation">(</span><span class="token string">&quot;WebSocketè¿æ¥å…³é—­&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//ç›‘å¬çª—å£å…³é—­äº‹ä»¶ï¼Œå½“çª—å£å…³é—­æ—¶ï¼Œä¸»åŠ¨å»å…³é—­websocketè¿æ¥ï¼Œé˜²æ­¢è¿æ¥è¿˜æ²¡æ–­å¼€å°±å…³é—­çª—å£ï¼Œserverç«¯ä¼šæŠ›å¼‚å¸¸ã€‚</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onbeforeunload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">closeWebSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//å°†æ¶ˆæ¯æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š</span>
    <span class="token keyword">function</span> <span class="token function">setMessageInnerHTML</span><span class="token punctuation">(</span><span class="token parameter">innerHTML</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> innerHTML <span class="token operator">+</span> <span class="token string">'&lt;br/&gt;'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//å…³é—­WebSocketè¿æ¥</span>
    <span class="token keyword">function</span> <span class="token function">closeWebSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        websocket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//å‘é€æ¶ˆæ¯</span>
    <span class="token keyword">function</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> message <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        websocket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><p><strong>5. æµ‹è¯•</strong></p> <p>åŒæ–¹äº’ç›¸å‘é€æ¶ˆæ¯~</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192408.png" alt="image-20201211090322335"></p> <p>åå°æ—¥å¿—æ‰“å°å½“å‰èŠå¤©äººæ•°ï¼š</p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/imgs02/20201211091551.png" alt=""></p> <br> <h2 id="_7-websocketä»‹ç»å’Œsocketçš„åŒºåˆ«"><a href="#_7-websocketä»‹ç»å’Œsocketçš„åŒºåˆ«" class="header-anchor">#</a> 7. WebSocketä»‹ç»å’ŒSocketçš„åŒºåˆ«</h2> <blockquote><p>ä»¥ä¸‹ä¸¤ä¸ªæ ‡é¢˜æ®µä¸ºè½¬è½½å†…å®¹ï¼ŒåŸæ–‡æŸ¥çœ‹ğŸ‘‰ä¸€ç¼•æ®‡æµåŒ–éšåŠè¾¹å†°éœœ.ã€Šè°ˆè°ˆ Websocketã€‹<a href="https://halfrost.com/ios_weixin_qq_websocket/" target="_blank" rel="noopener noreferrer">https://halfrost.com/ios_weixin_qq_websocket/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p><strong>Socket å…¶å®å¹¶ä¸æ˜¯ä¸€ä¸ªåè®®ã€‚å®ƒå·¥ä½œåœ¨ OSI æ¨¡å‹ä¼šè¯å±‚ï¼ˆç¬¬5å±‚ï¼‰ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿å¤§å®¶ç›´æ¥ä½¿ç”¨æ›´åº•å±‚åè®®ï¼ˆä¸€èˆ¬æ˜¯ TCP æˆ– UDP ï¼‰è€Œå­˜åœ¨çš„ä¸€ä¸ªæŠ½è±¡å±‚ã€‚Socketæ˜¯å¯¹TCP/IPåè®®çš„å°è£…ï¼ŒSocketæœ¬èº«å¹¶ä¸æ˜¯åè®®ï¼Œè€Œæ˜¯ä¸€ä¸ªè°ƒç”¨æ¥å£(API)ã€‚</strong></p> <p><img src="https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/20210626192414.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>å½“ä¸¤å°ä¸»æœºé€šä¿¡æ—¶ï¼Œå¿…é¡»é€šè¿‡Socketè¿æ¥ï¼ŒSocketåˆ™åˆ©ç”¨TCP/IPåè®®å»ºç«‹TCPè¿æ¥ã€‚TCPè¿æ¥åˆ™æ›´ä¾é äºåº•å±‚çš„IPåè®®ï¼ŒIPåè®®çš„è¿æ¥åˆ™ä¾èµ–äºé“¾è·¯å±‚ç­‰æ›´ä½å±‚æ¬¡ã€‚Socketæ˜¯ä¼ è¾“æ§åˆ¶å±‚åè®®ï¼ŒWebSocketæ˜¯åº”ç”¨å±‚åè®®ã€‚</p> <p>Socketé€šå¸¸ä¹Ÿç§°ä½œ <strong>å¥—æ¥å­—</strong>ï¼Œç”¨äºæè¿°IPåœ°å€å’Œç«¯å£ï¼Œæ˜¯ä¸€ä¸ªé€šä¿¡é“¾çš„å¥æŸ„ã€‚ç½‘ç»œä¸Šçš„ä¸¤ä¸ªç¨‹åºé€šè¿‡ä¸€ä¸ªåŒå‘çš„é€šè®¯è¿æ¥å®ç°æ•°æ®çš„äº¤æ¢ï¼Œè¿™ä¸ªåŒå‘é“¾è·¯çš„ä¸€ç«¯ç§°ä¸ºä¸€ä¸ªSocketï¼Œä¸€ä¸ªSocketç”±ä¸€ä¸ªIPåœ°å€å’Œä¸€ä¸ªç«¯å£å·å”¯ä¸€ç¡®å®šã€‚åº”ç”¨ç¨‹åºé€šå¸¸é€šè¿‡â€å¥—æ¥å­—â€å‘ç½‘ç»œå‘å‡ºè¯·æ±‚æˆ–è€…åº”ç­”ç½‘ç»œè¯·æ±‚ã€‚</p> <p>Socketåœ¨é€šè®¯è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡ç«¯ç›‘å¬æŸä¸ªç«¯å£æ˜¯å¦æœ‰è¿æ¥è¯·æ±‚ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¿æ¥è¯·æ±‚ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°è¿æ¥è¯·æ±‚å‘å®¢æˆ·ç«¯å‘å‡ºæ¥æ”¶æ¶ˆæ¯ï¼Œè¿™æ ·ä¸€ä¸ªè¿æ¥å°±å»ºç«‹èµ·æ¥äº†ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹Ÿéƒ½å¯ä»¥ç›¸äº’å‘é€æ¶ˆæ¯ä¸å¯¹æ–¹è¿›è¡Œé€šè®¯ï¼Œç›´åˆ°åŒæ–¹è¿æ¥æ–­å¼€ã€‚</p> <p>æ‰€ä»¥åŸºäºWebSocketå’ŒåŸºäºSocketéƒ½å¯ä»¥å¼€å‘å‡ºIMç¤¾äº¤èŠå¤©ç±»çš„å³æ—¶é€šè®¯app</p> <br> <h2 id="_8-websocketçš„ä½¿ç”¨åœºæ™¯"><a href="#_8-websocketçš„ä½¿ç”¨åœºæ™¯" class="header-anchor">#</a> 8. WebSocketçš„ä½¿ç”¨åœºæ™¯</h2> <p><strong>1.ç¤¾äº¤èŠå¤©</strong></p> <p>æœ€è‘—åçš„å°±æ˜¯å¾®ä¿¡ï¼ŒQQï¼Œè¿™ä¸€ç±»ç¤¾äº¤èŠå¤©çš„appã€‚è¿™ä¸€ç±»èŠå¤©appçš„ç‰¹ç‚¹æ˜¯ä½å»¶è¿Ÿï¼Œé«˜å³æ—¶ã€‚å³æ—¶æ˜¯è¿™é‡Œé¢è¦æ±‚æœ€é«˜çš„ï¼Œå¦‚æœæœ‰ä¸€ä¸ªç´§æ€¥çš„äº‹æƒ…ï¼Œé€šè¿‡IMè½¯ä»¶é€šçŸ¥ä½ ï¼Œå‡è®¾ç½‘ç»œç¯å¢ƒè‰¯å¥½çš„æƒ…å†µä¸‹ï¼Œè¿™æ¡messageè¿˜æ— æ³•ç«‹å³é€è¾¾åˆ°ä½ çš„å®¢æˆ·ç«¯ä¸Šï¼Œç´§æ€¥çš„äº‹æƒ…éƒ½ç»“æŸäº†ï¼Œä½ æ‰æ”¶åˆ°æ¶ˆæ¯ï¼Œé‚£ä¹ˆè¿™ä¸ªè½¯ä»¶è‚¯å®šæ˜¯å¤±è´¥çš„ã€‚</p> <p><strong>2.å¼¹å¹•</strong></p> <p>è¯´åˆ°è¿™é‡Œï¼Œå¤§å®¶ä¸€å®šé‡Œé¢æƒ³åˆ°äº†Aç«™å’ŒBç«™äº†ã€‚ç¡®å®ï¼Œä»–ä»¬çš„å¼¹å¹•ä¸€ç›´æ˜¯ä¸€ç§ç‰¹è‰²ã€‚è€Œä¸”å¼¹å¹•å¯¹äºä¸€ä¸ªè§†é¢‘æ¥è¯´ï¼Œå¾ˆå¯èƒ½å¼¹å¹•æ‰æ˜¯ç²¾åã€‚å‘å¼¹å¹•éœ€è¦å®æ—¶æ˜¾ç¤ºï¼Œä¹Ÿéœ€è¦å’ŒèŠå¤©ä¸€æ ·ï¼Œéœ€è¦å³æ—¶ã€‚</p> <p><strong>3.å¤šç©å®¶æ¸¸æˆ</strong></p> <p><strong>4.ååŒç¼–è¾‘</strong></p> <p>ç°åœ¨å¾ˆå¤šå¼€æºé¡¹ç›®éƒ½æ˜¯åˆ†æ•£åœ¨ä¸–ç•Œå„åœ°çš„å¼€å‘è€…ä¸€èµ·ååŒå¼€å‘ï¼Œæ­¤æ—¶å°±ä¼šç”¨åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œæ¯”å¦‚Gitï¼ŒSVNå»åˆå¹¶å†²çªã€‚ä½†æ˜¯å¦‚æœæœ‰ä¸€ä»½æ–‡æ¡£ï¼Œæ”¯æŒå¤šäººå®æ—¶åœ¨çº¿ååŒç¼–è¾‘ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ä¼šç”¨åˆ°æ¯”å¦‚WebSocketäº†ï¼Œå®ƒå¯ä»¥ä¿è¯å„ä¸ªç¼–è¾‘è€…éƒ½åœ¨ç¼–è¾‘åŒä¸€ä¸ªæ–‡æ¡£ï¼Œæ­¤æ—¶ä¸éœ€è¦ç”¨åˆ°Gitï¼ŒSVNè¿™äº›ç‰ˆæœ¬æ§åˆ¶ï¼Œå› ä¸ºåœ¨ååŒç¼–è¾‘ç•Œé¢å°±ä¼šå®æ—¶çœ‹åˆ°å¯¹æ–¹ç¼–è¾‘äº†ä»€ä¹ˆï¼Œè°åœ¨ä¿®æ”¹å“ªäº›æ®µè½å’Œæ–‡å­—ã€‚</p> <p><strong>5.è‚¡ç¥¨åŸºé‡‘å®æ—¶æŠ¥ä»·</strong></p> <p>é‡‘èç•Œç¬æ¯ä¸‡å˜â€”â€”å‡ ä¹æ˜¯æ¯æ¯«ç§’éƒ½åœ¨å˜åŒ–ã€‚å¦‚æœé‡‡ç”¨çš„ç½‘ç»œæ¶æ„æ— æ³•æ»¡è¶³å®æ—¶æ€§ï¼Œé‚£ä¹ˆå°±ä¼šç»™å®¢æˆ·å¸¦æ¥å·¨å¤§çš„æŸå¤±ã€‚å‡ æ¯«ç§’é’±è‚¡ç¥¨å¼€å§‹å¤§è·Œï¼Œå‡ ç§’ä»¥åæ‰åˆ·æ–°æ•°æ®ï¼Œä¸€ç§’é’Ÿçš„æ—¶é—´å†…ï¼Œå¾ˆå¯èƒ½ç”¨æˆ·å°±å·²ç»æŸå¤±å·¨å¤§è´¢äº§äº†ã€‚</p> <p><strong>6.ä½“è‚²å®å†µæ›´æ–°</strong></p> <p>å…¨ä¸–ç•Œçš„çƒè¿·ï¼Œä½“è‚²çˆ±å¥½è€…ç‰¹åˆ«å¤šï¼Œå½“ç„¶å¤§å®¶åœ¨å…³å¿ƒè‡ªå·±å–œæ¬¢çš„ä½“è‚²æ´»åŠ¨çš„æ—¶å€™ï¼Œæ¯”èµ›å®æ—¶çš„èµ›å†µæ˜¯ä»–ä»¬æœ€æœ€å…³å¿ƒçš„äº‹æƒ…ã€‚è¿™ç±»æ–°é—»ä¸­æœ€å¥½çš„ä½“éªŒå°±æ˜¯åˆ©ç”¨Websocketè¾¾åˆ°å®æ—¶çš„æ›´æ–°ï¼</p> <p><strong>7.è§†é¢‘ä¼šè®®/èŠå¤©</strong></p> <p>è§†é¢‘ä¼šè®®å¹¶ä¸èƒ½ä»£æ›¿å’ŒçœŸäººç›¸è§ï¼Œä½†æ˜¯ä»–èƒ½è®©åˆ†å¸ƒåœ¨å…¨çƒå¤©æ¶¯æµ·è§’çš„äººèšåœ¨ç”µè„‘å‰ä¸€èµ·å¼€ä¼šã€‚æ—¢èƒ½èŠ‚çœå¤§å®¶èšåœ¨ä¸€èµ·è·¯ä¸ŠèŠ±è´¹çš„æ—¶é—´ï¼Œè®¨è®ºèšä¼šåœ°ç‚¹çš„çº ç»“ï¼Œè¿˜èƒ½éšæ—¶éšåœ°ï¼Œåªè¦æœ‰ç½‘ç»œå°±å¯ä»¥å¼€ä¼šã€‚</p> <p><strong>8.åŸºäºä½ç½®çš„åº”ç”¨</strong></p> <p>è¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å€Ÿç”¨ç§»åŠ¨è®¾å¤‡çš„GPSåŠŸèƒ½æ¥å®ç°ä»–ä»¬åŸºäºä½ç½®çš„ç½‘ç»œåº”ç”¨ã€‚å¦‚æœä½ ä¸€ç›´è®°å½•ç”¨æˆ·çš„ä½ç½®(æ¯”å¦‚è¿è¡Œåº”ç”¨æ¥è®°å½•è¿åŠ¨è½¨è¿¹)ï¼Œä½ å¯ä»¥æ”¶é›†åˆ°æ›´åŠ ç»†è‡´åŒ–çš„æ•°æ®ã€‚</p> <p><strong>9.åœ¨çº¿æ•™è‚²</strong></p> <p>åœ¨çº¿æ•™è‚²è¿‘å‡ å¹´ä¹Ÿå‘å±•è¿…é€Ÿã€‚ä¼˜ç‚¹å¾ˆå¤šï¼Œå…å»äº†åœºåœ°çš„é™åˆ¶ï¼Œèƒ½è®©åå¸ˆçš„èµ„æºåˆç†çš„åˆ†é…ç»™å…¨å›½å„åœ°æƒ³è¦å­¦ä¹ çŸ¥è¯†çš„åŒå­¦æ‰‹ä¸Šï¼ŒWebsocketæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå¯ä»¥è§†é¢‘èŠå¤©ã€å³æ—¶èŠå¤©ä»¥åŠå…¶ä¸åˆ«äººåˆä½œä¸€èµ·åœ¨ç½‘ä¸Šè®¨è®ºé—®é¢˜...</p> <p><strong>10.æ™ºèƒ½å®¶å±…</strong></p> <p>è¿™ä¹Ÿæ˜¯æˆ‘ä¸€æ¯•ä¸šåŠ å…¥çš„ä¸€ä¸ªä¼Ÿå¤§çš„ç‰©è”ç½‘æ™ºèƒ½å®¶å±…çš„å…¬å¸ã€‚è€ƒè™‘åˆ°å®¶é‡Œçš„æ™ºèƒ½è®¾å¤‡çš„çŠ¶æ€å¿…é¡»éœ€è¦å®æ—¶çš„å±•ç°åœ¨æ‰‹æœºappå®¢æˆ·ç«¯ä¸Šï¼Œæ¯«æ— ç–‘é—®é€‰æ‹©äº†Websocketã€‚</p> <p>ä»ä¸Šé¢æˆ‘åˆ—ä¸¾çš„è¿™äº›åœºæ™¯æ¥çœ‹ï¼Œä¸€ä¸ªå…±åŒç‚¹å°±æ˜¯ï¼Œé«˜å®æ—¶æ€§ï¼</p> <hr> <p>ã€å‚è€ƒèµ„æ–™ã€‘</p> <p>[1] http://websocket.org/</p> <p>[2] HyBi Working Group.The WebSocket protocol.https://tools.ietf.org/html/draft-abarth-thewebsocketprotocol-00</p> <p>[3] wiki.websocket.https://en.wikipedia.org/wiki/WebSocket#:~:text=WebSocket</p> <p>[4] Google.WebRTC.https://webrtc.org/</p> <p>[5] IBM Developer.ä½¿ç”¨ HTML5 WebSocket æ„å»ºå®æ—¶ Web åº”ç”¨.https://developer.ibm.com/zh/articles/1112-huangxa-websocket/</p> <p>[6] spring.Using WebSocket to build an interactive web application.https://spring.io/guides/gs/messaging-stomp-websocket/</p> <p>[7] é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—.WebSocket.http://www.ruanyifeng.com/blog/2017/05/websocket.html</p> <p>[8] èœé¸Ÿæ•™ç¨‹.HTML5 WebSocket.https://www.runoob.com/html/html5-websocket.html</p> <p>[9] <a href="https://halfrost.com/author/halfrost/" target="_blank" rel="noopener noreferrer">ä¸€ç¼•æ®‡æµåŒ–éšåŠè¾¹å†°éœœ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.å…¨åŒå·¥é€šä¿¡çš„ WebSocket.https://halfrost.com/websocket/</p> <p>[10] å°è±†ä¸ä¸ªäººåšå®¢.SpringBootå®ç°Websocketé€šä¿¡è¯¦è§£.http://www.mydlq.club/article/86/</p></div></div> <div class="page-slot page-slot-bottom"><!-- æ¨ªå‘è‡ªé€‚åº” -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/iqqcode/icode/edit/master/docs/è®¡ç®—æœºç½‘ç»œ/02.TCP-IP/04.å…¨åŒå·¥é€šè®¯çš„WebSocketåè®®.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2021/06/27, 10:49:09</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/e15b33/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">HTTPS</div></a> <a href="/pages/544f29/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">DNS</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/e15b33/" class="prev">HTTPS</a></span> <span class="next"><a href="/pages/544f29/">DNS</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/e63701/"><div>
            åŒ¿åå†…éƒ¨ç±»
            <!----></div></a> <span class="date">10-08</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/2604eb/"><div>
            å‡½æ•°å¼æ¥å£
            <!----></div></a> <span class="date">10-08</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/b378a3/"><div>
            ARouter-Kotlinè¸©å‘
            <!----></div></a> <span class="date">10-05</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:iqqcode@qq.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/IQQcode" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://blog.csdn.net/weixin_43232955" title="CSDN" target="_blank" class="iconfont icon-csdn"></a><a href="https://www.zhihu.com/people/iqqcode" title="çŸ¥ä¹" target="_blank" class="iconfont icon-zhihu"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2021-2023
    <span>iqqcode  |  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a>  |  <a href="http://beian.miit.gov.cn/" target="_blank"> å¤‡æ¡ˆå·-äº¬ICPå¤‡2021028793å·</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">Ã—</span> <div><!-- å›ºå®š160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.c4fffd9b.js" defer></script><script src="/assets/js/2.9f83a926.js" defer></script><script src="/assets/js/403.c1141a30.js" defer></script>
  </body>
</html>
